import{r as Le}from"../chunks/index.g5YcAAdQ.js";import{e as _e,g as Ae}from"../chunks/route-for.2HUnMrnN.js";import{s as Te,h as B,j as J,k as H,f as v,m as z,i as L,c as de,T as Re,v as se,L as Ue,M as re,b as V,d as E,o as Fe,n as k,N as ne,t as x,l as ee,q as Pe}from"../chunks/scheduler.BTg3iwM1.js";import{S as Ee,i as je,g as ue,b as _,e as ie,t as d,f as ae,c as y,a as S,m as Q,d as W}from"../chunks/index.64bqrcBm.js";import{p as Ce}from"../chunks/stores.BcrvQPjq.js";import{P as Me}from"../chunks/page-title.CzCBRjr4.js";import{w as Ne,g as ze}from"../chunks/entry.DVdmGeHf.js";import{P as Be}from"../chunks/payload-input.DbpoRs0U.js";import{A as Je}from"../chunks/add-search-attributes.DRS0lVzF.js";import{A as Oe}from"../chunks/alert.DsYEO683.js";import{B as ve}from"../chunks/button.DErAHP2h.js";import{I as Ie}from"../chunks/input.QNFtIZwP.js";import{L as qe}from"../chunks/link.Cp0AyANh.js";import{L as He}from"../chunks/loading.BSNNT1ti.js";import{t as ge}from"../chunks/translate.BBe5dcco.js";import{g as Ke}from"../chunks/pollers-service.CFBECKBB.js";import{c as Ge,e as Xe,g as Ye}from"../chunks/workflows.BPnLjUEZ.js";import{c as Ze}from"../chunks/search-attributes.BTD2tcVV.js";import{p as ye}from"../chunks/format-time.6TuExJAg.js";import{u as Se}from"../chunks/update-query-parameters.CE0KzmEP.js";import{w as xe}from"../chunks/workflow-create-disabled.DRH_W9Z6.js";import{v as et}from"../chunks/toaster.C6ZGchz4.js";const tt=async function({params:n,parent:r}){if((await r()).settings.startWorkflowDisabled){const{namespace:t}=n;Le(302,_e({namespace:t}))}},qt=Object.freeze(Object.defineProperty({__proto__:null,load:tt},Symbol.toStringTag,{value:"Module"}));function rt(n){let r,e,t,a,u,i="Start a Workflow",f,l,c,p,h,b,K,T,I,R,C,U,j,G,X,te=n[6],Y,M,A,O,oe,q,le,N;e=new qe({props:{href:`${_e({namespace:n[12]})}?${n[13]}`,"data-testid":"back-to-workflows",icon:"chevron-left",$$slots:{default:[at]},$$scope:{ctx:n}}});function $e(o){n[20](o)}let fe={id:"workflowId",required:!0,label:"Workflow ID",class:"w-full grow"};n[0]!==void 0&&(fe.value=n[0]),c=new Ie({props:fe}),re.push(()=>ae(c,"value",$e)),c.$on("blur",n[21]),b=new ve({props:{class:"mt-0 md:mt-6",variant:"secondary",leadingIcon:"retry",$$slots:{default:[st]},$$scope:{ctx:n}}}),b.$on("click",n[15]);function we(o){n[22](o)}let ce={id:"taskQueue",required:!0,label:"Task Queue",class:"grow"};n[1]!==void 0&&(ce.value=n[1]),I=new Ie({props:ce}),re.push(()=>ae(I,"value",we)),I.$on("blur",n[23]);let g=n[8]!==void 0&&Qe(n);function be(o){n[24](o)}let pe={id:"workflowType",required:!0,label:"Workflow Type"};n[2]!==void 0&&(pe.value=n[2]),j=new Ie({props:pe}),re.push(()=>ae(j,"value",be)),j.$on("blur",n[25]);let D=We(n),$=n[9]&&De(n);O=new ve({props:{variant:"ghost",trailingIcon:n[9]?"chevron-up":"chevron-down",$$slots:{default:[ut]},$$scope:{ctx:n}}}),O.$on("click",n[29]),q=new ve({props:{disabled:!n[11],"data-testid":"start-workflow-button",$$slots:{default:[it]},$$scope:{ctx:n}}}),q.$on("click",n[14]);let w=n[7]&&Ve(n);return{c(){r=B("div"),y(e.$$.fragment),t=V(),a=B("div"),u=B("h1"),u.textContent=i,f=V(),l=B("div"),y(c.$$.fragment),h=V(),y(b.$$.fragment),K=V(),T=B("div"),y(I.$$.fragment),C=V(),g&&g.c(),U=V(),y(j.$$.fragment),X=V(),D.c(),Y=V(),$&&$.c(),M=V(),A=B("div"),y(O.$$.fragment),oe=V(),y(q.$$.fragment),le=V(),w&&w.c(),this.h()},l(o){r=J(o,"DIV",{class:!0});var s=H(r);S(e.$$.fragment,s),s.forEach(v),t=E(o),a=J(o,"DIV",{class:!0});var m=H(a);u=J(m,"H1",{class:!0,"data-testid":!0,"data-svelte-h":!0}),Fe(u)!=="svelte-16s98hn"&&(u.textContent=i),f=E(m),l=J(m,"DIV",{class:!0});var P=H(l);S(c.$$.fragment,P),h=E(P),S(b.$$.fragment,P),P.forEach(v),K=E(m),T=J(m,"DIV",{class:!0});var Z=H(T);S(I.$$.fragment,Z),Z.forEach(v),C=E(m),g&&g.l(m),U=E(m),S(j.$$.fragment,m),X=E(m),D.l(m),Y=E(m),$&&$.l(m),M=E(m),A=J(m,"DIV",{class:!0});var F=H(A);S(O.$$.fragment,F),oe=E(F),S(q.$$.fragment,F),F.forEach(v),le=E(m),w&&w.l(m),m.forEach(v),this.h()},h(){z(r,"class","mb-6 flex w-full items-start"),z(u,"class","mb-4 overflow-hidden"),z(u,"data-testid","start-workflow"),z(l,"class","flex w-full flex-col items-center justify-between gap-2 md:flex-row md:gap-4"),z(T,"class","flex w-full items-center justify-between gap-4"),z(A,"class","mt-4 flex w-full justify-between"),z(a,"class","flex w-full flex-col gap-4 lg:w-2/3 2xl:w-1/2")},m(o,s){L(o,r,s),Q(e,r,null),L(o,t,s),L(o,a,s),k(a,u),k(a,f),k(a,l),Q(c,l,null),k(l,h),Q(b,l,null),k(a,K),k(a,T),Q(I,T,null),k(a,C),g&&g.m(a,null),k(a,U),Q(j,a,null),k(a,X),D.m(a,null),k(a,Y),$&&$.m(a,null),k(a,M),k(a,A),Q(O,A,null),k(A,oe),Q(q,A,null),k(a,le),w&&w.m(a,null),N=!0},p(o,s){const m={};s[0]&12288&&(m.href=`${_e({namespace:o[12]})}?${o[13]}`),s[1]&64&&(m.$$scope={dirty:s,ctx:o}),e.$set(m);const P={};!p&&s[0]&1&&(p=!0,P.value=o[0],ne(()=>p=!1)),c.$set(P);const Z={};s[1]&64&&(Z.$$scope={dirty:s,ctx:o}),b.$set(Z);const F={};!R&&s[0]&2&&(R=!0,F.value=o[1],ne(()=>R=!1)),I.$set(F),o[8]!==void 0?g?(g.p(o,s),s[0]&256&&d(g,1)):(g=Qe(o),g.c(),d(g,1),g.m(a,U)):g&&(ue(),_(g,1,1,()=>{g=null}),ie());const me={};!G&&s[0]&4&&(G=!0,me.value=o[2],ne(()=>G=!1)),j.$set(me),s[0]&64&&Te(te,te=o[6])?(ue(),_(D,1,1,se),ie(),D=We(o),D.c(),d(D,1),D.m(a,Y)):D.p(o,s),o[9]?$?($.p(o,s),s[0]&512&&d($,1)):($=De(o),$.c(),d($,1),$.m(a,M)):$&&(ue(),_($,1,1,()=>{$=null}),ie());const he={};s[0]&512&&(he.trailingIcon=o[9]?"chevron-up":"chevron-down"),s[1]&64&&(he.$$scope={dirty:s,ctx:o}),O.$set(he);const ke={};s[0]&2048&&(ke.disabled=!o[11]),s[1]&64&&(ke.$$scope={dirty:s,ctx:o}),q.$set(ke),o[7]?w?(w.p(o,s),s[0]&128&&d(w,1)):(w=Ve(o),w.c(),d(w,1),w.m(a,null)):w&&(ue(),_(w,1,1,()=>{w=null}),ie())},i(o){N||(d(e.$$.fragment,o),d(c.$$.fragment,o),d(b.$$.fragment,o),d(I.$$.fragment,o),d(g),d(j.$$.fragment,o),d(D),d($),d(O.$$.fragment,o),d(q.$$.fragment,o),d(w),N=!0)},o(o){_(e.$$.fragment,o),_(c.$$.fragment,o),_(b.$$.fragment,o),_(I.$$.fragment,o),_(g),_(j.$$.fragment,o),_(D),_($),_(O.$$.fragment,o),_(q.$$.fragment,o),_(w),N=!1},d(o){o&&(v(r),v(t),v(a)),W(e),W(c),W(b),W(I),g&&g.d(),W(j),D.d(o),$&&$.d(),W(O),W(q),w&&w.d()}}}function nt(n){let r,e;return r=new He({props:{title:ge("workflows.starting-workflow")}}),{c(){y(r.$$.fragment)},l(t){S(r.$$.fragment,t)},m(t,a){Q(r,t,a),e=!0},p:se,i(t){e||(d(r.$$.fragment,t),e=!0)},o(t){_(r.$$.fragment,t),e=!1},d(t){W(r,t)}}}function at(n){let r=ge("workflows.back-to-workflows")+"",e;return{c(){e=x(r)},l(t){e=ee(t,r)},m(t,a){L(t,e,a)},p:se,d(t){t&&v(e)}}}function st(n){let r;return{c(){r=x("Random UUID")},l(e){r=ee(e,"Random UUID")},m(e,t){L(e,r,t)},d(e){e&&v(r)}}}function Qe(n){let r,e;return r=new Oe({props:{intent:n[8]>0?"success":"warning",title:n[8]?"Task Queue is Active":"Task Queue is Inactive",$$slots:{default:[lt]},$$scope:{ctx:n}}}),{c(){y(r.$$.fragment)},l(t){S(r.$$.fragment,t)},m(t,a){Q(r,t,a),e=!0},p(t,a){const u={};a[0]&256&&(u.intent=t[8]>0?"success":"warning"),a[0]&256&&(u.title=t[8]?"Task Queue is Active":"Task Queue is Inactive"),a[0]&4354|a[1]&64&&(u.$$scope={dirty:a,ctx:t}),r.$set(u)},i(t){e||(d(r.$$.fragment,t),e=!0)},o(t){_(r.$$.fragment,t),e=!1},d(t){W(r,t)}}}function ot(n){let r;return{c(){r=x("View Task Queue")},l(e){r=ee(e,"View Task Queue")},m(e,t){L(e,r,t)},d(e){e&&v(r)}}}function lt(n){let r,e,t,a,u=ye("Worker",n[8])+"",i,f,l,c;return l=new qe({props:{href:Ae({namespace:n[12],queue:n[1]}),newTab:!0,$$slots:{default:[ot]},$$scope:{ctx:n}}}),{c(){r=B("div"),e=B("p"),t=x(n[8]),a=V(),i=x(u),f=V(),y(l.$$.fragment),this.h()},l(p){r=J(p,"DIV",{class:!0});var h=H(r);e=J(h,"P",{});var b=H(e);t=ee(b,n[8]),a=E(b),i=ee(b,u),b.forEach(v),f=E(h),S(l.$$.fragment,h),h.forEach(v),this.h()},h(){z(r,"class","flex w-full items-center justify-between")},m(p,h){L(p,r,h),k(r,e),k(e,t),k(e,a),k(e,i),k(r,f),Q(l,r,null),c=!0},p(p,h){(!c||h[0]&256)&&Pe(t,p[8]),(!c||h[0]&256)&&u!==(u=ye("Worker",p[8])+"")&&Pe(i,u);const b={};h[0]&4098&&(b.href=Ae({namespace:p[12],queue:p[1]})),h[1]&64&&(b.$$scope={dirty:h,ctx:p}),l.$set(b)},i(p){c||(d(l.$$.fragment,p),c=!0)},o(p){_(l.$$.fragment,p),c=!1},d(p){p&&v(r),W(l)}}}function We(n){let r,e,t,a;function u(l){n[26](l)}function i(l){n[27](l)}let f={};return n[3]!==void 0&&(f.input=n[3]),n[5]!==void 0&&(f.encoding=n[5]),r=new Be({props:f}),re.push(()=>ae(r,"input",u)),re.push(()=>ae(r,"encoding",i)),{c(){y(r.$$.fragment)},l(l){S(r.$$.fragment,l)},m(l,c){Q(r,l,c),a=!0},p(l,c){const p={};!e&&c[0]&8&&(e=!0,p.input=l[3],ne(()=>e=!1)),!t&&c[0]&32&&(t=!0,p.encoding=l[5],ne(()=>t=!1)),r.$set(p)},i(l){a||(d(r.$$.fragment,l),a=!0)},o(l){_(r.$$.fragment,l),a=!1},d(l){W(r,l)}}}function De(n){let r,e,t;function a(i){n[28](i)}let u={};return n[10]!==void 0&&(u.attributesToAdd=n[10]),r=new Je({props:u}),re.push(()=>ae(r,"attributesToAdd",a)),{c(){y(r.$$.fragment)},l(i){S(r.$$.fragment,i)},m(i,f){Q(r,i,f),t=!0},p(i,f){const l={};!e&&f[0]&1024&&(e=!0,l.attributesToAdd=i[10],ne(()=>e=!1)),r.$set(l)},i(i){t||(d(r.$$.fragment,i),t=!0)},o(i){_(r.$$.fragment,i),t=!1},d(i){W(r,i)}}}function ut(n){let r=ge("common.more-options")+"",e;return{c(){e=x(r)},l(t){e=ee(t,r)},m(t,a){L(t,e,a)},p:se,d(t){t&&v(e)}}}function it(n){let r=ge("workflows.start-workflow")+"",e;return{c(){e=x(r)},l(t){e=ee(t,r)},m(t,a){L(t,e,a)},p:se,d(t){t&&v(e)}}}function Ve(n){let r,e;return r=new Oe({props:{intent:"error",title:n[7]}}),{c(){y(r.$$.fragment)},l(t){S(r.$$.fragment,t)},m(t,a){Q(r,t,a),e=!0},p(t,a){const u={};a[0]&128&&(u.title=t[7]),r.$set(u)},i(t){e||(d(r.$$.fragment,t),e=!0)},o(t){_(r.$$.fragment,t),e=!1},d(t){W(r,t)}}}function ft(n){let r,e,t,a;const u=[nt,rt],i=[];function f(l,c){return l[4]?0:1}return e=f(n),t=i[e]=u[e](n),{c(){r=B("div"),t.c(),this.h()},l(l){r=J(l,"DIV",{class:!0});var c=H(r);t.l(c),c.forEach(v),this.h()},h(){z(r,"class","flex w-full flex-col items-center pb-24")},m(l,c){L(l,r,c),i[e].m(r,null),a=!0},p(l,c){let p=e;e=f(l),e===p?i[e].p(l,c):(ue(),_(i[p],1,1,()=>{i[p]=null}),ie(),t=i[e],t?t.p(l,c):(t=i[e]=u[e](l),t.c()),d(t,1),t.m(r,null))},i(l){a||(d(t),a=!0)},o(l){_(t),a=!1},d(l){l&&v(r),i[e].d()}}}function ct(n,r,e){let t,a,u,i,f,l,c,p=se,h=()=>(p(),p=Ue(U,s=>e(33,c=s)),U),b;de(n,Ce,s=>e(19,f=s)),de(n,Ze,s=>e(32,l=s)),de(n,Ge,s=>e(13,b=s)),n.$$.on_destroy.push(()=>p());let K=!1,T="",I="",R="",C="",U=Ne("json/plain");h();let j=0,G="",X="",te="",Y,M=!1,A=[];Re(()=>{e(0,T=f.url.searchParams.get("workflowId")||""),e(1,I=f.url.searchParams.get("taskQueue")||""),e(2,R=f.url.searchParams.get("workflowType")||""),G=f.url.searchParams.get("workflowId")||"",X=f.url.searchParams.get("workflowType")||"",(G||X)&&le(G,X)});const O=async()=>{e(4,K=!0);try{e(7,te=""),await Ye({namespace:t,workflowId:T,taskQueue:I,workflowType:R,input:C,encoding:c,searchAttributes:A}),await new Promise(s=>setTimeout(s,2e3)),ze(_e({namespace:t}))}catch(s){e(7,te=(s==null?void 0:s.message)||"Error starting Workflow"),e(4,K=!1)}},oe=()=>{e(0,T=et()),Se({parameter:"workflowId",value:T,url:f.url,allowEmpty:!0})},q=async s=>{if(s){const{pollers:m}=await Ke({namespace:t,queue:s});e(8,Y=m.length)}},le=async(s,m)=>{const P=await Xe({namespace:t,workflowId:s,workflowType:m});if(e(3,C=P.input),e(6,j=Date.now()),P!=null&&P.searchAttributes){const Z=Object.keys(l);Object.entries(P.searchAttributes).forEach(([F,me])=>{Z.includes(F)&&e(10,A=[...A,{attribute:F,value:String(me)}])}),e(9,M=!0)}},N=(s,m)=>{const P=s.target.value;Se({parameter:m,value:P,url:f.url,allowEmpty:!0})},$e=s=>{try{return JSON.parse(s),!0}catch{return!1}};function fe(s){T=s,e(0,T)}const we=s=>N(s,"workflowId");function ce(s){I=s,e(1,I)}const g=s=>N(s,"taskQueue");function be(s){R=s,e(2,R)}const pe=s=>N(s,"workflowType");function D(s){C=s,e(3,C)}function $(s){U=s,h(e(5,U))}function w(s){A=s,e(10,A)}const o=()=>e(9,M=!M);return n.$$.update=()=>{n.$$.dirty[0]&524288&&e(12,{namespace:t}=f.params,t),n.$$.dirty[0]&524288&&e(17,a=f.url.searchParams.get("taskQueue")),n.$$.dirty[0]&8&&e(18,u=!C||$e(C)),n.$$.dirty[0]&786439&&e(11,i=!!T&&!!I&&!!R&&!!u&&!xe(f)),n.$$.dirty[0]&131072&&q(a)},[T,I,R,C,K,U,j,te,Y,M,A,i,t,b,O,oe,N,a,u,f,fe,we,ce,g,be,pe,D,$,w,o]}class pt extends Ee{constructor(r){super(),je(this,r,ct,ft,Te,{},null,[-1,-1])}}function mt(n){let r,e,t,a;return r=new Me({props:{title:"Start Workflow",url:n[0].url.href}}),t=new pt({}),{c(){y(r.$$.fragment),e=V(),y(t.$$.fragment)},l(u){S(r.$$.fragment,u),e=E(u),S(t.$$.fragment,u)},m(u,i){Q(r,u,i),L(u,e,i),Q(t,u,i),a=!0},p(u,[i]){const f={};i&1&&(f.url=u[0].url.href),r.$set(f)},i(u){a||(d(r.$$.fragment,u),d(t.$$.fragment,u),a=!0)},o(u){_(r.$$.fragment,u),_(t.$$.fragment,u),a=!1},d(u){u&&v(e),W(r,u),W(t,u)}}}function dt(n,r,e){let t;return de(n,Ce,a=>e(0,t=a)),[t]}class Lt extends Ee{constructor(r){super(),je(this,r,dt,mt,Te,{})}}export{Lt as component,qt as universal};
