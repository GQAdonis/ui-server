import{s as x,h as E,j as T,k as j,f as p,i as d,c as U,v as q,b as V,d as B,m as C,n as N,N as G,O as H,t as F,l as z,x as J,y as fe,q as ce}from"../chunks/scheduler.C46pS-76.js";import{S as ee,i as te,t as $,b as g,c as h,a as w,m as k,d as b,f as K,g as ie,e as me}from"../chunks/index.dOVbn71B.js";import{p as re}from"../chunks/stores.CSypd5vm.js";import{P as pe}from"../chunks/page-title.DNhqE1Lj.js";import{t as _}from"../chunks/translate.BBe5dcco.js";import{W as $e}from"../chunks/workflow-padded-layout.DTPWvpOw.js";import{h as A,u as ne}from"../chunks/await_block.BfN27BCg.js";import{e as M}from"../chunks/each.C6O0oV7R.js";import{P as ge}from"../chunks/payload-input.C5XAeh5g.js";import{B as _e}from"../chunks/button.6V75PaG_.js";import{C as de}from"../chunks/card.DbXyfCsc.js";import{C as he}from"../chunks/code-block.m75J9ijT.js";import{E as le}from"../chunks/empty-state.BO9uOKUe.js";import{L as we}from"../chunks/loading.BLsNkl8r.js";import{S as ke,O as be}from"../chunks/option.cPJWt0Bx.js";import{T as ye}from"../chunks/toggle-switch.C9lxIG0w.js";import{a as ve,b as qe}from"../chunks/query-service.BBTqooqT.js";import{a as Ie}from"../chunks/auth-user.CqYO1ufZ.js";import{e as Pe}from"../chunks/encode-payload.Be55Sisw.js";import{s as Ee}from"../chunks/parse-with-big-int.BKSBwM2t.js";function X(a){a[23]=a[25][0],a[24]=a[25][1];const e=typeof a[23]!="string"?Ee(a[23]):a[23];a[26]=e}function Y(a,e,n){const r=a.slice();return r[25]=e[n],r}function Te(a){var r,t;let e,n;return e=new le({props:{title:_("common.error-occurred"),content:_("workflows.no-workers-running-message"),error:(t=(r=a[27])==null?void 0:r.body)==null?void 0:t.message}}),{c(){h(e.$$.fragment)},l(l){w(e.$$.fragment,l)},m(l,o){k(e,l,o),n=!0},p:q,i(l){n||($(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){b(e,l)}}}function je(a){let e,n,r,t,l,o;n=new de({props:{class:"mt-7 flex h-fit w-full flex-col gap-2",$$slots:{default:[Ve]},$$scope:{ctx:a}}});let s={ctx:a,current:null,token:null,hasCatch:!0,pending:We,then:Oe,catch:Be,value:25,error:27,blocks:[,,,]};return A(l=Promise.all([a[4],a[5]]),s),{c(){e=E("div"),h(n.$$.fragment),r=V(),t=E("div"),s.block.c(),this.h()},l(u){e=T(u,"DIV",{class:!0});var f=j(e);w(n.$$.fragment,f),r=B(f),t=T(f,"DIV",{class:!0});var i=j(t);s.block.l(i),i.forEach(p),f.forEach(p),this.h()},h(){C(t,"class","flex w-full flex-col gap-2"),C(e,"class","flex w-3/4 gap-4 max-2xl:w-full max-lg:flex-col")},m(u,f){d(u,e,f),k(n,e,null),N(e,r),N(e,t),s.block.m(t,s.anchor=null),s.mount=()=>t,s.anchor=null,o=!0},p(u,f){a=u;const i={};f&1073741895&&(i.$$scope={dirty:f,ctx:a}),n.$set(i),s.ctx=a,f&48&&l!==(l=Promise.all([a[4],a[5]]))&&A(l,s)||ne(s,a,f)},i(u){o||($(n.$$.fragment,u),$(s.block),o=!0)},o(u){g(n.$$.fragment,u);for(let f=0;f<3;f+=1){const i=s.blocks[f];g(i)}o=!1},d(u){u&&p(e),b(n),s.block.d(),s.token=null,s=null}}}function Ce(a){let e=a[25]+"",n;return{c(){n=F(e)},l(r){n=z(r,e)},m(r,t){d(r,n,t)},p:q,d(r){r&&p(n)}}}function Z(a){let e,n;return e=new be({props:{value:a[25],$$slots:{default:[Ce]},$$scope:{ctx:a}}}),{c(){h(e.$$.fragment)},l(r){w(e.$$.fragment,r)},m(r,t){k(e,r,t),n=!0},p(r,t){const l={};t&1073741824&&(l.$$scope={dirty:t,ctx:r}),e.$set(l)},i(r){n||($(e.$$.fragment,r),n=!0)},o(r){g(e.$$.fragment,r),n=!1},d(r){b(e,r)}}}function De(a){let e,n,r=M(a[22]),t=[];for(let o=0;o<r.length;o+=1)t[o]=Z(Y(a,r,o));const l=o=>g(t[o],1,1,()=>{t[o]=null});return{c(){for(let o=0;o<t.length;o+=1)t[o].c();e=J()},l(o){for(let s=0;s<t.length;s+=1)t[s].l(o);e=J()},m(o,s){for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(o,s);d(o,e,s),n=!0},p(o,s){if(s&128){r=M(o[22]);let u;for(u=0;u<r.length;u+=1){const f=Y(o,r,u);t[u]?(t[u].p(f,s),$(t[u],1)):(t[u]=Z(f),t[u].c(),$(t[u],1),t[u].m(e.parentNode,e))}for(ie(),u=r.length;u<t.length;u+=1)l(u);me()}},i(o){if(!n){for(let s=0;s<r.length;s+=1)$(t[s]);n=!0}},o(o){t=t.filter(Boolean);for(let s=0;s<t.length;s+=1)g(t[s]);n=!1},d(o){o&&p(e),fe(t,o)}}}function Se(a){let e=(a[6]?_("workflows.run-query"):_("workflows.refresh-query"))+"",n;return{c(){n=F(e)},l(r){n=z(r,e)},m(r,t){d(r,n,t)},p(r,t){t&64&&e!==(e=(r[6]?_("workflows.run-query"):_("workflows.refresh-query"))+"")&&ce(n,e)},d(r){r&&p(n)}}}function Ve(a){let e,n,r,t,l,o,s,u,f,i;function O(c){a[11](c)}let v={id:"query-select",label:_("workflows.query-type"),"data-testid":"query-select",required:!0,$$slots:{default:[De]},$$scope:{ctx:a}};a[0]!==void 0&&(v.value=a[0]),e=new ke({props:v}),G.push(()=>K(e,"value",O));function W(c){a[12](c)}let D={label:_("workflows.query-arg")};return a[1]!==void 0&&(D.input=a[1]),l=new ge({props:D}),G.push(()=>K(l,"input",W)),f=new _e({props:{loading:a[2],variant:a[6]?"primary":"secondary",leadingIcon:a[6]?null:"retry",disabled:a[2],$$slots:{default:[Se]},$$scope:{ctx:a}}}),f.$on("click",a[13]),{c(){h(e.$$.fragment),r=V(),t=E("div"),h(l.$$.fragment),s=V(),u=E("div"),h(f.$$.fragment),this.h()},l(c){w(e.$$.fragment,c),r=B(c),t=T(c,"DIV",{class:!0});var m=j(t);w(l.$$.fragment,m),m.forEach(p),s=B(c),u=T(c,"DIV",{class:!0});var I=j(u);w(f.$$.fragment,I),I.forEach(p),this.h()},h(){C(t,"class","flex flex-col gap-1"),C(u,"class","flex w-full flex-wrap items-end justify-end gap-4")},m(c,m){k(e,c,m),d(c,r,m),d(c,t,m),k(l,t,null),d(c,s,m),d(c,u,m),k(f,u,null),i=!0},p(c,m){const I={};m&1073741824&&(I.$$scope={dirty:m,ctx:c}),!n&&m&1&&(n=!0,I.value=c[0],H(()=>n=!1)),e.$set(I);const S={};!o&&m&2&&(o=!0,S.input=c[1],H(()=>o=!1)),l.$set(S);const P={};m&4&&(P.loading=c[2]),m&64&&(P.variant=c[6]?"primary":"secondary"),m&64&&(P.leadingIcon=c[6]?null:"retry"),m&4&&(P.disabled=c[2]),m&1073741888&&(P.$$scope={dirty:m,ctx:c}),f.$set(P)},i(c){i||($(e.$$.fragment,c),$(l.$$.fragment,c),$(f.$$.fragment,c),i=!0)},o(c){g(e.$$.fragment,c),g(l.$$.fragment,c),g(f.$$.fragment,c),i=!1},d(c){c&&(p(r),p(t),p(s),p(u)),b(e,c),b(l),b(f)}}}function Be(a){var r;let e,n;return e=new le({props:{title:_("common.error-occurred"),error:(r=a[27])==null?void 0:r.message}}),{c(){h(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,l){k(e,t,l),n=!0},p(t,l){var s;const o={};l&48&&(o.error=(s=t[27])==null?void 0:s.message),e.$set(o)},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){g(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Oe(a){X(a);let e,n,r,t,l;return n=new ye({props:{label:_("workflows.json-formatting"),labelPosition:"left",id:"json-formatting",checked:a[3]}}),n.$on("change",a[14]),t=new he({props:{content:a[26],language:a[3]?"json":"text",copyIconTitle:_("common.copy-icon-title"),copySuccessIconTitle:_("common.copy-success-icon-title"),testId:"query-result",class:a[6]&&"opacity-50"}}),{c(){e=E("div"),h(n.$$.fragment),r=V(),h(t.$$.fragment),this.h()},l(o){e=T(o,"DIV",{class:!0});var s=j(e);w(n.$$.fragment,s),s.forEach(p),r=B(o),w(t.$$.fragment,o),this.h()},h(){C(e,"class","ml-auto")},m(o,s){d(o,e,s),k(n,e,null),d(o,r,s),k(t,o,s),l=!0},p(o,s){X(o);const u={};s&8&&(u.checked=o[3]),n.$set(u);const f={};s&48&&(f.content=o[26]),s&8&&(f.language=o[3]?"json":"text"),s&64&&(f.class=o[6]&&"opacity-50"),t.$set(f)},i(o){l||($(n.$$.fragment,o),$(t.$$.fragment,o),l=!0)},o(o){g(n.$$.fragment,o),g(t.$$.fragment,o),l=!1},d(o){o&&(p(e),p(r)),b(n),b(t,o)}}}function We(a){return{c:q,l:q,m:q,p:q,i:q,o:q,d:q}}function Ne(a){let e,n,r,t,l=_("workflows.no-workers-failure-message")+"",o,s;return n=new we({}),{c(){e=E("div"),h(n.$$.fragment),r=V(),t=E("p"),o=F(l),this.h()},l(u){e=T(u,"DIV",{class:!0});var f=j(e);w(n.$$.fragment,f),r=B(f),t=T(f,"P",{class:!0});var i=j(t);o=z(i,l),i.forEach(p),f.forEach(p),this.h()},h(){C(t,"class","-mt-10"),C(e,"class","text-center")},m(u,f){d(u,e,f),k(n,e,null),N(e,r),N(e,t),N(t,o),s=!0},p:q,i(u){s||($(n.$$.fragment,u),s=!0)},o(u){g(n.$$.fragment,u),s=!1},d(u){u&&p(e),b(n)}}}function Qe(a){let e,n,r={ctx:a,current:null,token:null,hasCatch:!0,pending:Ne,then:je,catch:Te,value:22,error:27,blocks:[,,,]};return A(a[7],r),{c(){e=E("section"),r.block.c()},l(t){e=T(t,"SECTION",{});var l=j(e);r.block.l(l),l.forEach(p)},m(t,l){d(t,e,l),r.block.m(e,r.anchor=null),r.mount=()=>e,r.anchor=null,n=!0},p(t,[l]){a=t,ne(r,a,l)},i(t){n||($(r.block),n=!0)},o(t){for(let l=0;l<3;l+=1){const o=r.blocks[l];g(o)}n=!1},d(t){t&&p(e),r.block.d(),r.token=null,r=null}}}function Le(a,e,n){let r,t,l;U(a,Ie,y=>n(15,t=y)),U(a,re,y=>n(16,l=y));const{namespace:o,workflow:s,run:u}=l.params,f={id:s,runId:u};let i,O,v="",W="",D=!1,c=!0,m=ve({namespace:o,workflow:f}).then(y=>(n(0,i=i||y[0]),Q(i),y)),I,S;const P=()=>{n(2,D=!1),n(9,O=i),n(10,W=v)},Q=async y=>{var L;n(2,D=!0);let R;try{n(5,S=v?Pe(v,"json/plain",!1):Promise.resolve(null)),R=await S}catch{P();return}n(4,I=qe({namespace:o,workflow:f,queryType:y,queryArgs:R?{payloads:R}:null},(L=l.data)===null||L===void 0?void 0:L.settings,t==null?void 0:t.accessToken).finally(()=>{P()}))};function oe(y){i=y,n(0,i)}function ae(y){v=y,n(1,v)}const se=()=>Q(i),ue=()=>n(3,c=!c);return a.$$.update=()=>{a.$$.dirty&1539&&n(6,r=O!==i||v!==W)},[i,v,D,c,I,S,r,m,Q,O,W,oe,ae,se,ue]}class Re extends ee{constructor(e){super(),te(this,e,Le,Qe,x,{})}}function Ue(a){let e,n;return e=new Re({}),{c(){h(e.$$.fragment)},l(r){w(e.$$.fragment,r)},m(r,t){k(e,r,t),n=!0},i(r){n||($(e.$$.fragment,r),n=!0)},o(r){g(e.$$.fragment,r),n=!1},d(r){b(e,r)}}}function Ae(a){let e,n,r,t;return e=new pe({props:{title:`${_("workflows.queries-tab")} | ${a[1]}`,url:a[0].url.href}}),r=new $e({props:{$$slots:{default:[Ue]},$$scope:{ctx:a}}}),{c(){h(e.$$.fragment),n=V(),h(r.$$.fragment)},l(l){w(e.$$.fragment,l),n=B(l),w(r.$$.fragment,l)},m(l,o){k(e,l,o),d(l,n,o),k(r,l,o),t=!0},p(l,[o]){const s={};o&1&&(s.url=l[0].url.href),e.$set(s);const u={};o&4&&(u.$$scope={dirty:o,ctx:l}),r.$set(u)},i(l){t||($(e.$$.fragment,l),$(r.$$.fragment,l),t=!0)},o(l){g(e.$$.fragment,l),g(r.$$.fragment,l),t=!1},d(l){l&&p(n),b(e,l),b(r,l)}}}function Fe(a,e,n){let r;U(a,re,l=>n(0,r=l));const t=r.params.workflow;return[r,t]}class it extends ee{constructor(e){super(),te(this,e,Fe,Ae,x,{})}}export{it as component};
