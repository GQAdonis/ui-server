import{r as Ue}from"../chunks/index.g5YcAAdQ.js";import{e as Te,g as Pe,b as Le}from"../chunks/route-for.A0MsG6lo.js";import{s as Ae,M as ne,h as M,b as y,j as N,k as H,f as I,d as Q,o as Me,m as L,i as J,n as w,N as ae,v as fe,c as _e,T as Ne,t as Y,l as Z,q as Se,L as ze}from"../chunks/scheduler.BTg3iwM1.js";import{S as qe,i as Ce,f as se,c as W,a as D,m as V,t as m,g as de,b,e as ge,d as E}from"../chunks/index.64bqrcBm.js";import{p as Oe}from"../chunks/stores.Bl6h2Z44.js";import{P as Be}from"../chunks/page-title.CzCBRjr4.js";import{w as He}from"../chunks/entry.CzmNI18i.js";import{P as Je}from"../chunks/payload-input.CtaYj1Bo.js";import{A as Ke}from"../chunks/add-search-attributes.tpvc8ran.js";import{A as Fe}from"../chunks/alert.DsYEO683.js";import{B as ve}from"../chunks/button.DV9Yq2Xd.js";import{I as Ie}from"../chunks/input.Dmp19-OH.js";import{L as Re}from"../chunks/link.5Vv66y18.js";import{t as oe}from"../chunks/translate.BBe5dcco.js";import{g as Ge}from"../chunks/pollers-service.Ck-P-mz3.js";import{c as Xe,e as Ye,g as Ze}from"../chunks/workflows.C0LmsUKt.js";import{c as xe}from"../chunks/search-attributes.DwWaXUDT.js";import{t as ye,v as et}from"../chunks/toaster.CrfvoMQr.js";import{p as Qe}from"../chunks/format-time.6TuExJAg.js";import{u as We}from"../chunks/update-query-parameters.CQJepwcf.js";import{w as tt}from"../chunks/workflow-create-disabled.DiWBmwFO.js";const rt=async function({params:n,parent:e}){if((await e()).settings.startWorkflowDisabled){const{namespace:r}=n;Ue(302,Te({namespace:r}))}},qt=Object.freeze(Object.defineProperty({__proto__:null,load:rt},Symbol.toStringTag,{value:"Module"}));function nt(n){let e=oe("workflows.back-to-workflows")+"",t;return{c(){t=Y(e)},l(r){t=Z(r,e)},m(r,l){J(r,t,l)},p:fe,d(r){r&&I(t)}}}function at(n){let e;return{c(){e=Y("Random UUID")},l(t){e=Z(t,"Random UUID")},m(t,r){J(t,e,r)},d(t){t&&I(e)}}}function De(n){let e,t;return e=new Fe({props:{intent:n[7]>0?"success":"warning",title:n[7]?"Task Queue is Active":"Task Queue is Inactive",$$slots:{default:[ot]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment)},l(r){D(e.$$.fragment,r)},m(r,l){V(e,r,l),t=!0},p(r,l){const a={};l[0]&128&&(a.intent=r[7]>0?"success":"warning"),l[0]&128&&(a.title=r[7]?"Task Queue is Active":"Task Queue is Inactive"),l[0]&2178|l[1]&32&&(a.$$scope={dirty:l,ctx:r}),e.$set(a)},i(r){t||(m(e.$$.fragment,r),t=!0)},o(r){b(e.$$.fragment,r),t=!1},d(r){E(e,r)}}}function st(n){let e;return{c(){e=Y("View Task Queue")},l(t){e=Z(t,"View Task Queue")},m(t,r){J(t,e,r)},d(t){t&&I(e)}}}function ot(n){let e,t,r,l,a=Qe("Worker",n[7])+"",u,c,f,g;return f=new Re({props:{href:Pe({namespace:n[11],queue:n[1]}),newTab:!0,$$slots:{default:[st]},$$scope:{ctx:n}}}),{c(){e=M("div"),t=M("p"),r=Y(n[7]),l=y(),u=Y(a),c=y(),W(f.$$.fragment),this.h()},l(p){e=N(p,"DIV",{class:!0});var h=H(e);t=N(h,"P",{});var T=H(t);r=Z(T,n[7]),l=Q(T),u=Z(T,a),T.forEach(I),c=Q(h),D(f.$$.fragment,h),h.forEach(I),this.h()},h(){L(e,"class","flex w-full items-center justify-between")},m(p,h){J(p,e,h),w(e,t),w(t,r),w(t,l),w(t,u),w(e,c),V(f,e,null),g=!0},p(p,h){(!g||h[0]&128)&&Se(r,p[7]),(!g||h[0]&128)&&a!==(a=Qe("Worker",p[7])+"")&&Se(u,a);const T={};h[0]&2050&&(T.href=Pe({namespace:p[11],queue:p[1]})),h[1]&32&&(T.$$scope={dirty:h,ctx:p}),f.$set(T)},i(p){g||(m(f.$$.fragment,p),g=!0)},o(p){b(f.$$.fragment,p),g=!1},d(p){p&&I(e),E(f)}}}function Ve(n){let e,t,r,l;function a(f){n[25](f)}function u(f){n[26](f)}let c={};return n[3]!==void 0&&(c.input=n[3]),n[4]!==void 0&&(c.encoding=n[4]),e=new Je({props:c}),ne.push(()=>se(e,"input",a)),ne.push(()=>se(e,"encoding",u)),{c(){W(e.$$.fragment)},l(f){D(e.$$.fragment,f)},m(f,g){V(e,f,g),l=!0},p(f,g){const p={};!t&&g[0]&8&&(t=!0,p.input=f[3],ae(()=>t=!1)),!r&&g[0]&16&&(r=!0,p.encoding=f[4],ae(()=>r=!1)),e.$set(p)},i(f){l||(m(e.$$.fragment,f),l=!0)},o(f){b(e.$$.fragment,f),l=!1},d(f){E(e,f)}}}function Ee(n){let e,t,r;function l(u){n[27](u)}let a={};return n[9]!==void 0&&(a.attributesToAdd=n[9]),e=new Ke({props:a}),ne.push(()=>se(e,"attributesToAdd",l)),{c(){W(e.$$.fragment)},l(u){D(e.$$.fragment,u)},m(u,c){V(e,u,c),r=!0},p(u,c){const f={};!t&&c[0]&512&&(t=!0,f.attributesToAdd=u[9],ae(()=>t=!1)),e.$set(f)},i(u){r||(m(e.$$.fragment,u),r=!0)},o(u){b(e.$$.fragment,u),r=!1},d(u){E(e,u)}}}function lt(n){let e=oe("common.more-options")+"",t;return{c(){t=Y(e)},l(r){t=Z(r,e)},m(r,l){J(r,t,l)},p:fe,d(r){r&&I(t)}}}function ut(n){let e=oe("workflows.start-workflow")+"",t;return{c(){t=Y(e)},l(r){t=Z(r,e)},m(r,l){J(r,t,l)},p:fe,d(r){r&&I(t)}}}function je(n){let e,t;return e=new Fe({props:{intent:"error",title:n[6]}}),{c(){W(e.$$.fragment)},l(r){D(e.$$.fragment,r)},m(r,l){V(e,r,l),t=!0},p(r,l){const a={};l[0]&64&&(a.title=r[6]),e.$set(a)},i(r){t||(m(e.$$.fragment,r),t=!0)},o(r){b(e.$$.fragment,r),t=!1},d(r){E(e,r)}}}function it(n){let e,t,r,l,a,u,c="Start a Workflow",f,g,p,h,T,k,O,j,v,R,x,z,A,K,ee,G=n[5],q,te,F,C,le,P,ue,re;r=new Re({props:{href:`${Te({namespace:n[11]})}?${n[12]}`,"data-testid":"back-to-workflows",icon:"chevron-left",$$slots:{default:[nt]},$$scope:{ctx:n}}});function $e(o){n[19](o)}let pe={id:"workflowId",required:!0,label:"Workflow ID",class:"w-full grow"};n[0]!==void 0&&(pe.value=n[0]),p=new Ie({props:pe}),ne.push(()=>se(p,"value",$e)),p.$on("blur",n[20]),k=new ve({props:{class:"mt-0 md:mt-6",variant:"secondary",leadingIcon:"retry",$$slots:{default:[at]},$$scope:{ctx:n}}}),k.$on("click",n[14]);function we(o){n[21](o)}let ce={id:"taskQueue",required:!0,label:"Task Queue",class:"grow"};n[1]!==void 0&&(ce.value=n[1]),v=new Ie({props:ce}),ne.push(()=>se(v,"value",we)),v.$on("blur",n[22]);let _=n[7]!==void 0&&De(n);function be(o){n[23](o)}let me={id:"workflowType",required:!0,label:"Workflow Type"};n[2]!==void 0&&(me.value=n[2]),A=new Ie({props:me}),ne.push(()=>se(A,"value",be)),A.$on("blur",n[24]);let S=Ve(n),$=n[8]&&Ee(n);C=new ve({props:{variant:"ghost",trailingIcon:n[8]?"chevron-up":"chevron-down",$$slots:{default:[lt]},$$scope:{ctx:n}}}),C.$on("click",n[28]),P=new ve({props:{disabled:!n[10],"data-testid":"start-workflow-button",$$slots:{default:[ut]},$$scope:{ctx:n}}}),P.$on("click",n[13]);let s=n[6]&&je(n);return{c(){e=M("div"),t=M("div"),W(r.$$.fragment),l=y(),a=M("div"),u=M("h1"),u.textContent=c,f=y(),g=M("div"),W(p.$$.fragment),T=y(),W(k.$$.fragment),O=y(),j=M("div"),W(v.$$.fragment),x=y(),_&&_.c(),z=y(),W(A.$$.fragment),ee=y(),S.c(),q=y(),$&&$.c(),te=y(),F=M("div"),W(C.$$.fragment),le=y(),W(P.$$.fragment),ue=y(),s&&s.c(),this.h()},l(o){e=N(o,"DIV",{class:!0});var i=H(e);t=N(i,"DIV",{class:!0});var B=H(t);D(r.$$.fragment,B),B.forEach(I),l=Q(i),a=N(i,"DIV",{class:!0});var d=H(a);u=N(d,"H1",{class:!0,"data-testid":!0,"data-svelte-h":!0}),Me(u)!=="svelte-8dv4qj"&&(u.textContent=c),f=Q(d),g=N(d,"DIV",{class:!0});var U=H(g);D(p.$$.fragment,U),T=Q(U),D(k.$$.fragment,U),U.forEach(I),O=Q(d),j=N(d,"DIV",{class:!0});var ie=H(j);D(v.$$.fragment,ie),ie.forEach(I),x=Q(d),_&&_.l(d),z=Q(d),D(A.$$.fragment,d),ee=Q(d),S.l(d),q=Q(d),$&&$.l(d),te=Q(d),F=N(d,"DIV",{class:!0});var X=H(F);D(C.$$.fragment,X),le=Q(X),D(P.$$.fragment,X),X.forEach(I),ue=Q(d),s&&s.l(d),d.forEach(I),i.forEach(I),this.h()},h(){L(t,"class","mb-6 flex w-full items-start"),L(u,"class","mb-4 overflow-hidden"),L(u,"data-testid","start-workflow"),L(g,"class","flex w-full flex-col items-center justify-between gap-2 md:flex-row md:gap-4"),L(j,"class","flex w-full items-center justify-between gap-4"),L(F,"class","mt-4 flex w-full justify-between"),L(a,"class","flex w-full flex-col gap-4 lg:w-2/3 2xl:w-1/2"),L(e,"class","flex w-full flex-col items-center pb-24")},m(o,i){J(o,e,i),w(e,t),V(r,t,null),w(e,l),w(e,a),w(a,u),w(a,f),w(a,g),V(p,g,null),w(g,T),V(k,g,null),w(a,O),w(a,j),V(v,j,null),w(a,x),_&&_.m(a,null),w(a,z),V(A,a,null),w(a,ee),S.m(a,null),w(a,q),$&&$.m(a,null),w(a,te),w(a,F),V(C,F,null),w(F,le),V(P,F,null),w(a,ue),s&&s.m(a,null),re=!0},p(o,i){const B={};i[0]&6144&&(B.href=`${Te({namespace:o[11]})}?${o[12]}`),i[1]&32&&(B.$$scope={dirty:i,ctx:o}),r.$set(B);const d={};!h&&i[0]&1&&(h=!0,d.value=o[0],ae(()=>h=!1)),p.$set(d);const U={};i[1]&32&&(U.$$scope={dirty:i,ctx:o}),k.$set(U);const ie={};!R&&i[0]&2&&(R=!0,ie.value=o[1],ae(()=>R=!1)),v.$set(ie),o[7]!==void 0?_?(_.p(o,i),i[0]&128&&m(_,1)):(_=De(o),_.c(),m(_,1),_.m(a,z)):_&&(de(),b(_,1,1,()=>{_=null}),ge());const X={};!K&&i[0]&4&&(K=!0,X.value=o[2],ae(()=>K=!1)),A.$set(X),i[0]&32&&Ae(G,G=o[5])?(de(),b(S,1,1,fe),ge(),S=Ve(o),S.c(),m(S,1),S.m(a,q)):S.p(o,i),o[8]?$?($.p(o,i),i[0]&256&&m($,1)):($=Ee(o),$.c(),m($,1),$.m(a,te)):$&&(de(),b($,1,1,()=>{$=null}),ge());const he={};i[0]&256&&(he.trailingIcon=o[8]?"chevron-up":"chevron-down"),i[1]&32&&(he.$$scope={dirty:i,ctx:o}),C.$set(he);const ke={};i[0]&1024&&(ke.disabled=!o[10]),i[1]&32&&(ke.$$scope={dirty:i,ctx:o}),P.$set(ke),o[6]?s?(s.p(o,i),i[0]&64&&m(s,1)):(s=je(o),s.c(),m(s,1),s.m(a,null)):s&&(de(),b(s,1,1,()=>{s=null}),ge())},i(o){re||(m(r.$$.fragment,o),m(p.$$.fragment,o),m(k.$$.fragment,o),m(v.$$.fragment,o),m(_),m(A.$$.fragment,o),m(S),m($),m(C.$$.fragment,o),m(P.$$.fragment,o),m(s),re=!0)},o(o){b(r.$$.fragment,o),b(p.$$.fragment,o),b(k.$$.fragment,o),b(v.$$.fragment,o),b(_),b(A.$$.fragment,o),b(S),b($),b(C.$$.fragment,o),b(P.$$.fragment,o),b(s),re=!1},d(o){o&&I(e),E(r),E(p),E(k),E(v),_&&_.d(),E(A),S.d(o),$&&$.d(),E(C),E(P),s&&s.d()}}}function ft(n,e,t){let r,l,a,u,c,f,g,p=fe,h=()=>(p(),p=ze(R,s=>t(32,g=s)),R),T;_e(n,Oe,s=>t(18,c=s)),_e(n,xe,s=>t(31,f=s)),_e(n,Xe,s=>t(12,T=s)),n.$$.on_destroy.push(()=>p());let k="",O="",j="",v="",R=He("json/plain");h();let x=0,z="",A="",K="",ee,G=!1,q=[];Ne(()=>{t(0,k=c.url.searchParams.get("workflowId")||""),t(1,O=c.url.searchParams.get("taskQueue")||""),t(2,j=c.url.searchParams.get("workflowType")||""),z=c.url.searchParams.get("workflowId")||"",A=c.url.searchParams.get("workflowType")||"",(z||A)&&le(z,A)});const te=async()=>{try{t(6,K="");const{runId:s}=await Ze({namespace:r,workflowId:k,taskQueue:O,workflowType:j,input:v,encoding:g,searchAttributes:q});ye.push({variant:"success",duration:5e3,message:oe("workflows.start-workflow-success"),link:Le({namespace:r,workflow:k,run:s})})}catch(s){t(6,K=(s==null?void 0:s.message)||oe("workflows.start-workflow-error")),ye.push({variant:"error",message:oe("workflows.start-workflow-error")})}},F=()=>{t(0,k=et()),We({parameter:"workflowId",value:k,url:c.url,allowEmpty:!0})},C=async s=>{if(s){const{pollers:o}=await Ge({namespace:r,queue:s});t(7,ee=o.length)}},le=async(s,o)=>{const i=await Ye({namespace:r,workflowId:s,workflowType:o});if(t(3,v=i.input),t(5,x=Date.now()),i!=null&&i.searchAttributes){const B=Object.keys(f);Object.entries(i.searchAttributes).forEach(([d,U])=>{B.includes(d)&&t(9,q=[...q,{attribute:d,value:String(U)}])}),t(8,G=!0)}},P=(s,o)=>{const i=s.target.value;We({parameter:o,value:i,url:c.url,allowEmpty:!0})},ue=s=>{try{return JSON.parse(s),!0}catch{return!1}};function re(s){k=s,t(0,k)}const $e=s=>P(s,"workflowId");function pe(s){O=s,t(1,O)}const we=s=>P(s,"taskQueue");function ce(s){j=s,t(2,j)}const _=s=>P(s,"workflowType");function be(s){v=s,t(3,v)}function me(s){R=s,h(t(4,R))}function S(s){q=s,t(9,q)}const $=()=>t(8,G=!G);return n.$$.update=()=>{n.$$.dirty[0]&262144&&t(11,{namespace:r}=c.params,r),n.$$.dirty[0]&262144&&t(16,l=c.url.searchParams.get("taskQueue")),n.$$.dirty[0]&8&&t(17,a=!v||ue(v)),n.$$.dirty[0]&393223&&t(10,u=!!k&&!!O&&!!j&&!!a&&!tt(c)),n.$$.dirty[0]&65536&&C(l)},[k,O,j,v,R,x,K,ee,G,q,u,r,T,te,F,P,l,a,c,re,$e,pe,we,ce,_,be,me,S,$]}class pt extends qe{constructor(e){super(),Ce(this,e,ft,it,Ae,{},null,[-1,-1])}}function ct(n){let e,t,r,l;return e=new Be({props:{title:"Start Workflow",url:n[0].url.href}}),r=new pt({}),{c(){W(e.$$.fragment),t=y(),W(r.$$.fragment)},l(a){D(e.$$.fragment,a),t=Q(a),D(r.$$.fragment,a)},m(a,u){V(e,a,u),J(a,t,u),V(r,a,u),l=!0},p(a,[u]){const c={};u&1&&(c.url=a[0].url.href),e.$set(c)},i(a){l||(m(e.$$.fragment,a),m(r.$$.fragment,a),l=!0)},o(a){b(e.$$.fragment,a),b(r.$$.fragment,a),l=!1},d(a){a&&I(t),E(e,a),E(r,a)}}}function mt(n,e,t){let r;return _e(n,Oe,l=>t(0,r=l)),[r]}class Ct extends qe{constructor(e){super(),Ce(this,e,mt,ct,Ae,{})}}export{Ct as component,qt as universal};
