import{r as xe}from"../chunks/index.aHWtvSLc.js";import{e as Se,g as qe}from"../chunks/route-for.RguSoEqc.js";import{s as De,h as y,b as S,j as C,k as F,f as _,d as D,m as h,i as B,p as et,L as ve,o as tt,n as $,a0 as Ie,v as Ee,c as Te,S as rt,t as le,l as ne,q as Le}from"../chunks/scheduler.OdTyv_h4.js";import{S as We,i as je,c as E,a as P,m as Q,t as p,b as w,d as V,f as Ae,g as _e,e as he}from"../chunks/index.oB682ev8.js";import{p as Ke}from"../chunks/stores.hmp8xZHl.js";import{P as lt}from"../chunks/page-title.3SKch4kC.js";import{g as nt}from"../chunks/entry.ENL0I50f.js";import{A as at}from"../chunks/add-search-attributes.714wS7Su.js";import{A as Ne}from"../chunks/alert.iFy3EeW4.js";import{B as Qe}from"../chunks/button.sQtUMdnQ.js";import{C as Ge}from"../chunks/code-block.h3UXJYfL.js";import{I as st}from"../chunks/icon.TYqb0IgV.js";import{t as ie}from"../chunks/translate.HrioCK44.js";import{t as ot,v as ft}from"../chunks/toaster.OlmVa01U.js";import{I as Ve}from"../chunks/input.ma0j4lHC.js";import{L as Je}from"../chunks/label.gagZy3Y3.js";import{L as Xe}from"../chunks/link.NPTmASz6.js";import{g as ut}from"../chunks/pollers-service.msJoxkKK.js";import{e as it,g as ct,h as mt}from"../chunks/workflows.-tluN5X_.js";import{c as pt}from"../chunks/search-attributes.TOszNuUL.js";import{p as Fe}from"../chunks/format-time.SD8Sj6b-.js";import{u as Oe}from"../chunks/update-query-parameters.mWmiVDbR.js";import{w as dt}from"../chunks/workflow-create-disabled.HmbLmA0C.js";const gt=async function({params:l,parent:e}){if((await e()).settings.startWorkflowDisabled){const{namespace:r}=l;xe(302,Se({namespace:r}))}},xt=Object.freeze(Object.defineProperty({__proto__:null,load:gt},Symbol.toStringTag,{value:"Module"}));function $t(l){let e,t,r,a,n,s,c;return t=new st({props:{name:"upload"}}),{c(){e=y("label"),E(t.$$.fragment),r=S(),a=y("input"),this.h()},l(u){e=C(u,"LABEL",{for:!0,class:!0});var i=F(e);P(t.$$.fragment,i),i.forEach(_),r=D(u),a=C(u,"INPUT",{id:!0,class:!0,type:!0,accept:!0}),this.h()},h(){h(e,"for",l[0]),h(e,"class","file-upload-label svelte-nqh6y4"),h(a,"id",l[0]),h(a,"class","hidden"),h(a,"type","file"),h(a,"accept",l[1])},m(u,i){B(u,e,i),Q(t,e,null),B(u,r,i),B(u,a,i),n=!0,s||(c=et(a,"change",l[2]),s=!0)},p(u,[i]){(!n||i&1)&&h(e,"for",u[0]),(!n||i&1)&&h(a,"id",u[0]),(!n||i&2)&&h(a,"accept",u[1])},i(u){n||(p(t.$$.fragment,u),n=!0)},o(u){w(t.$$.fragment,u),n=!1},d(u){u&&(_(e),_(r),_(a)),V(t),s=!1,c()}}}function wt(l,e,t){let{id:r}=e,{accept:a=".json"}=e,{onUpload:n}=e;const s=async c=>{var u;const i=c.target,m=(u=i==null?void 0:i.files)===null||u===void 0?void 0:u[0],g=new FileReader;m&&(g.readAsText(m),g.onload=()=>{var b,W;try{const z=(W=(b=g==null?void 0:g.result)===null||b===void 0?void 0:b.toString())!==null&&W!==void 0?W:"";n(z)}catch{ot.push({variant:"error",message:ie("common.upload-error")})}})};return l.$$set=c=>{"id"in c&&t(0,r=c.id),"accept"in c&&t(1,a=c.accept),"onUpload"in c&&t(3,n=c.onUpload)},[r,a,s,n]}class _t extends We{constructor(e){super(),je(this,e,wt,$t,De,{id:0,accept:1,onUpload:3})}}function ht(l){let e=ie("workflows.back-to-workflows")+"",t;return{c(){t=le(e)},l(r){t=ne(r,e)},m(r,a){B(r,t,a)},p:Ee,d(r){r&&_(t)}}}function bt(l){let e;return{c(){e=le("Random UUID")},l(t){e=ne(t,"Random UUID")},m(t,r){B(t,e,r)},d(t){t&&_(e)}}}function Re(l){let e,t;return e=new Ne({props:{intent:l[7]>0?"success":"warning",title:l[7]?"Task Queue is Active":"Task Queue is Inactive",$$slots:{default:[vt]},$$scope:{ctx:l}}}),{c(){E(e.$$.fragment)},l(r){P(e.$$.fragment,r)},m(r,a){Q(e,r,a),t=!0},p(r,a){const n={};a[0]&128&&(n.intent=r[7]>0?"success":"warning"),a[0]&128&&(n.title=r[7]?"Task Queue is Active":"Task Queue is Inactive"),a[0]&2178|a[1]&4&&(n.$$scope={dirty:a,ctx:r}),e.$set(n)},i(r){t||(p(e.$$.fragment,r),t=!0)},o(r){w(e.$$.fragment,r),t=!1},d(r){V(e,r)}}}function kt(l){let e;return{c(){e=le("View Task Queue")},l(t){e=ne(t,"View Task Queue")},m(t,r){B(t,e,r)},d(t){t&&_(e)}}}function vt(l){let e,t,r,a,n=Fe("Worker",l[7])+"",s,c,u,i;return u=new Xe({props:{href:qe({namespace:l[11],queue:l[1]}),newTab:!0,$$slots:{default:[kt]},$$scope:{ctx:l}}}),{c(){e=y("div"),t=y("p"),r=le(l[7]),a=S(),s=le(n),c=S(),E(u.$$.fragment),this.h()},l(m){e=C(m,"DIV",{class:!0});var g=F(e);t=C(g,"P",{});var b=F(t);r=ne(b,l[7]),a=D(b),s=ne(b,n),b.forEach(_),c=D(g),P(u.$$.fragment,g),g.forEach(_),this.h()},h(){h(e,"class","flex w-full items-center justify-between")},m(m,g){B(m,e,g),$(e,t),$(t,r),$(t,a),$(t,s),$(e,c),Q(u,e,null),i=!0},p(m,g){(!i||g[0]&128)&&Le(r,m[7]),(!i||g[0]&128)&&n!==(n=Fe("Worker",m[7])+"")&&Le(s,n);const b={};g[0]&2050&&(b.href=qe({namespace:m[11],queue:m[1]})),g[1]&4&&(b.$$scope={dirty:g,ctx:m}),u.$set(b)},i(m){i||(p(u.$$.fragment,m),i=!0)},o(m){w(u.$$.fragment,m),i=!1},d(m){m&&_(e),V(u)}}}function Be(l){let e,t,r,a,n;return t=new Je({props:{class:"text-subtle",for:"workflow-example-input",label:ie("workflows.example-input")}}),a=new Ge({props:{id:"workflow-initial-input",minHeight:120,content:l[5],copyable:!0}}),{c(){e=y("div"),E(t.$$.fragment),r=S(),E(a.$$.fragment),this.h()},l(s){e=C(s,"DIV",{class:!0});var c=F(e);P(t.$$.fragment,c),r=D(c),P(a.$$.fragment,c),c.forEach(_),this.h()},h(){h(e,"class","flex w-full flex-col gap-2 md:w-1/2")},m(s,c){B(s,e,c),Q(t,e,null),$(e,r),Q(a,e,null),n=!0},p(s,c){const u={};c[0]&32&&(u.content=s[5]),a.$set(u)},i(s){n||(p(t.$$.fragment,s),p(a.$$.fragment,s),n=!0)},o(s){w(t.$$.fragment,s),w(a.$$.fragment,s),n=!1},d(s){s&&_(e),V(t),V(a)}}}function He(l){let e,t;return e=new Ge({props:{id:"workflow-input",minHeight:120,content:l[3],editable:!0,copyable:!1}}),e.$on("change",l[13]),{c(){E(e.$$.fragment)},l(r){P(e.$$.fragment,r)},m(r,a){Q(e,r,a),t=!0},p(r,a){const n={};a[0]&8&&(n.content=r[3]),e.$set(n)},i(r){t||(p(e.$$.fragment,r),t=!0)},o(r){w(e.$$.fragment,r),t=!1},d(r){V(e,r)}}}function ze(l){let e,t,r;function a(s){l[26](s)}let n={};return l[9]!==void 0&&(n.attributesToAdd=l[9]),e=new at({props:n}),ve.push(()=>Ae(e,"attributesToAdd",a)),{c(){E(e.$$.fragment)},l(s){P(e.$$.fragment,s)},m(s,c){Q(e,s,c),r=!0},p(s,c){const u={};!t&&c[0]&512&&(t=!0,u.attributesToAdd=s[9],Ie(()=>t=!1)),e.$set(u)},i(s){r||(p(e.$$.fragment,s),r=!0)},o(s){w(e.$$.fragment,s),r=!1},d(s){V(e,s)}}}function It(l){let e=ie("common.more-options")+"",t;return{c(){t=le(e)},l(r){t=ne(r,e)},m(r,a){B(r,t,a)},p:Ee,d(r){r&&_(t)}}}function Tt(l){let e=ie("workflows.start-workflow")+"",t;return{c(){t=le(e)},l(r){t=ne(r,e)},m(r,a){B(r,t,a)},p:Ee,d(r){r&&_(t)}}}function Me(l){let e,t;return e=new Ne({props:{intent:"error",title:l[6]}}),{c(){E(e.$$.fragment)},l(r){P(e.$$.fragment,r)},m(r,a){Q(e,r,a),t=!0},p(r,a){const n={};a[0]&64&&(n.title=r[6]),e.$set(n)},i(r){t||(p(e.$$.fragment,r),t=!0)},o(r){w(e.$$.fragment,r),t=!1},d(r){V(e,r)}}}function At(l){let e,t,r,a,n,s,c="Start a Workflow",u,i,m,g,b,W,z,M,q,ee,ae,N,j,ce,me,H,se,O,L,G,pe,J,de,be=l[4],oe,ge,fe,K,f,X,U,$e,Y;r=new Xe({props:{href:`${Se({namespace:l[11]})}?${l[12]}`,"data-testid":"back-to-workflows",icon:"chevron-left",$$slots:{default:[ht]},$$scope:{ctx:l}}});function Pe(o){l[20](o)}let Ue={id:"workflowId",required:!0,label:"Workflow ID",class:"w-full grow"};l[0]!==void 0&&(Ue.value=l[0]),m=new Ve({props:Ue}),ve.push(()=>Ae(m,"value",Pe)),m.$on("blur",l[21]),W=new Qe({props:{class:"mt-0 md:mt-6",variant:"secondary",leadingIcon:"retry",$$slots:{default:[bt]},$$scope:{ctx:l}}}),W.$on("click",l[15]);function Ye(o){l[22](o)}let ye={id:"taskQueue",required:!0,label:"Task Queue",class:"grow"};l[1]!==void 0&&(ye.value=l[1]),q=new Ve({props:ye}),ve.push(()=>Ae(q,"value",Ye)),q.$on("blur",l[23]);let v=l[7]!==void 0&&Re(l);function Ze(o){l[24](o)}let Ce={id:"workflowType",required:!0,label:"Workflow Type"};l[2]!==void 0&&(Ce.value=l[2]),j=new Ve({props:Ce}),ve.push(()=>Ae(j,"value",Ze)),j.$on("blur",l[25]);let I=l[5]&&Be(l);G=new Je({props:{for:"workflow-input",label:ie("workflows.input")}}),J=new _t({props:{id:"start-workflow-input-file-upload",onUpload:l[17]}});let R=He(l),T=l[8]&&ze(l);f=new Qe({props:{variant:"ghost",trailingIcon:l[8]?"chevron-up":"chevron-down",$$slots:{default:[It]},$$scope:{ctx:l}}}),f.$on("click",l[27]),U=new Qe({props:{disabled:!l[10],"data-testid":"start-workflow-button",$$slots:{default:[Tt]},$$scope:{ctx:l}}}),U.$on("click",l[14]);let A=l[6]&&Me(l);return{c(){e=y("div"),t=y("div"),E(r.$$.fragment),a=S(),n=y("div"),s=y("h1"),s.textContent=c,u=S(),i=y("div"),E(m.$$.fragment),b=S(),E(W.$$.fragment),z=S(),M=y("div"),E(q.$$.fragment),ae=S(),v&&v.c(),N=S(),E(j.$$.fragment),me=S(),H=y("div"),I&&I.c(),se=S(),O=y("div"),L=y("div"),E(G.$$.fragment),pe=S(),E(J.$$.fragment),de=S(),R.c(),ge=S(),T&&T.c(),fe=S(),K=y("div"),E(f.$$.fragment),X=S(),E(U.$$.fragment),$e=S(),A&&A.c(),this.h()},l(o){e=C(o,"DIV",{class:!0});var d=F(e);t=C(d,"DIV",{class:!0});var ue=F(t);P(r.$$.fragment,ue),ue.forEach(_),a=D(d),n=C(d,"DIV",{class:!0});var k=F(n);s=C(k,"H1",{class:!0,"data-testid":!0,"data-svelte-h":!0}),tt(s)!=="svelte-8dv4qj"&&(s.textContent=c),u=D(k),i=C(k,"DIV",{class:!0});var te=F(i);P(m.$$.fragment,te),b=D(te),P(W.$$.fragment,te),te.forEach(_),z=D(k),M=C(k,"DIV",{class:!0});var we=F(M);P(q.$$.fragment,we),we.forEach(_),ae=D(k),v&&v.l(k),N=D(k),P(j.$$.fragment,k),me=D(k),H=C(k,"DIV",{class:!0});var re=F(H);I&&I.l(re),se=D(re),O=C(re,"DIV",{class:!0});var Z=F(O);L=C(Z,"DIV",{class:!0});var x=F(L);P(G.$$.fragment,x),pe=D(x),P(J.$$.fragment,x),x.forEach(_),de=D(Z),R.l(Z),Z.forEach(_),re.forEach(_),ge=D(k),T&&T.l(k),fe=D(k),K=C(k,"DIV",{class:!0});var ke=F(K);P(f.$$.fragment,ke),X=D(ke),P(U.$$.fragment,ke),ke.forEach(_),$e=D(k),A&&A.l(k),k.forEach(_),d.forEach(_),this.h()},h(){h(t,"class","mb-6 flex w-full items-start"),h(s,"class","mb-4 overflow-hidden"),h(s,"data-testid","start-workflow"),h(i,"class","flex w-full flex-col items-center justify-between gap-2 md:flex-row md:gap-4"),h(M,"class","flex w-full items-center justify-between gap-4"),h(L,"class","flex w-full items-end justify-between"),h(O,"class",oe="flex w-full flex-col gap-2 "+(l[5]&&"md:w-1/2")),h(H,"class","flex w-full flex-col items-end justify-between gap-4 md:flex-row"),h(K,"class","mt-4 flex w-full justify-between"),h(n,"class","flex w-full flex-col gap-4 lg:w-2/3 2xl:w-1/2"),h(e,"class","flex w-full flex-col items-center pb-24")},m(o,d){B(o,e,d),$(e,t),Q(r,t,null),$(e,a),$(e,n),$(n,s),$(n,u),$(n,i),Q(m,i,null),$(i,b),Q(W,i,null),$(n,z),$(n,M),Q(q,M,null),$(n,ae),v&&v.m(n,null),$(n,N),Q(j,n,null),$(n,me),$(n,H),I&&I.m(H,null),$(H,se),$(H,O),$(O,L),Q(G,L,null),$(L,pe),Q(J,L,null),$(O,de),R.m(O,null),$(n,ge),T&&T.m(n,null),$(n,fe),$(n,K),Q(f,K,null),$(K,X),Q(U,K,null),$(n,$e),A&&A.m(n,null),Y=!0},p(o,d){const ue={};d[0]&6144&&(ue.href=`${Se({namespace:o[11]})}?${o[12]}`),d[1]&4&&(ue.$$scope={dirty:d,ctx:o}),r.$set(ue);const k={};!g&&d[0]&1&&(g=!0,k.value=o[0],Ie(()=>g=!1)),m.$set(k);const te={};d[1]&4&&(te.$$scope={dirty:d,ctx:o}),W.$set(te);const we={};!ee&&d[0]&2&&(ee=!0,we.value=o[1],Ie(()=>ee=!1)),q.$set(we),o[7]!==void 0?v?(v.p(o,d),d[0]&128&&p(v,1)):(v=Re(o),v.c(),p(v,1),v.m(n,N)):v&&(_e(),w(v,1,1,()=>{v=null}),he());const re={};!ce&&d[0]&4&&(ce=!0,re.value=o[2],Ie(()=>ce=!1)),j.$set(re),o[5]?I?(I.p(o,d),d[0]&32&&p(I,1)):(I=Be(o),I.c(),p(I,1),I.m(H,se)):I&&(_e(),w(I,1,1,()=>{I=null}),he()),d[0]&16&&De(be,be=o[4])?(_e(),w(R,1,1,Ee),he(),R=He(o),R.c(),p(R,1),R.m(O,null)):R.p(o,d),(!Y||d[0]&32&&oe!==(oe="flex w-full flex-col gap-2 "+(o[5]&&"md:w-1/2")))&&h(O,"class",oe),o[8]?T?(T.p(o,d),d[0]&256&&p(T,1)):(T=ze(o),T.c(),p(T,1),T.m(n,fe)):T&&(_e(),w(T,1,1,()=>{T=null}),he());const Z={};d[0]&256&&(Z.trailingIcon=o[8]?"chevron-up":"chevron-down"),d[1]&4&&(Z.$$scope={dirty:d,ctx:o}),f.$set(Z);const x={};d[0]&1024&&(x.disabled=!o[10]),d[1]&4&&(x.$$scope={dirty:d,ctx:o}),U.$set(x),o[6]?A?(A.p(o,d),d[0]&64&&p(A,1)):(A=Me(o),A.c(),p(A,1),A.m(n,null)):A&&(_e(),w(A,1,1,()=>{A=null}),he())},i(o){Y||(p(r.$$.fragment,o),p(m.$$.fragment,o),p(W.$$.fragment,o),p(q.$$.fragment,o),p(v),p(j.$$.fragment,o),p(I),p(G.$$.fragment,o),p(J.$$.fragment,o),p(R),p(T),p(f.$$.fragment,o),p(U.$$.fragment,o),p(A),Y=!0)},o(o){w(r.$$.fragment,o),w(m.$$.fragment,o),w(W.$$.fragment,o),w(q.$$.fragment,o),w(v),w(j.$$.fragment,o),w(I),w(G.$$.fragment,o),w(J.$$.fragment,o),w(R),w(T),w(f.$$.fragment,o),w(U.$$.fragment,o),w(A),Y=!1},d(o){o&&_(e),V(r),V(m),V(W),V(q),v&&v.d(),V(j),I&&I.d(),V(G),V(J),R.d(o),T&&T.d(),V(f),V(U),A&&A.d()}}}function St(l,e,t){let r,a,n,s,c,u;Te(l,Ke,f=>t(19,s=f)),Te(l,pt,f=>t(30,c=f)),Te(l,it,f=>t(12,u=f));let i="",m="",g="",b="",W=0,z="",M="",q="",ee="",ae,N=!1,j=[];rt(()=>{t(0,i=s.url.searchParams.get("workflowId")||""),t(1,m=s.url.searchParams.get("taskQueue")||""),t(2,g=s.url.searchParams.get("workflowType")||""),z=s.url.searchParams.get("workflowId")||"",M=s.url.searchParams.get("workflowType")||"",(z||M)&&O(z,M)});const ce=f=>{t(3,b=f.detail)},me=async()=>{try{t(6,ee=""),await mt({namespace:r,workflowId:i,taskQueue:m,workflowType:g,input:b,searchAttributes:j}),nt(Se({namespace:r}))}catch(f){t(6,ee=(f==null?void 0:f.message)||"Error start Workflow")}},H=()=>{t(0,i=ft()),Oe({parameter:"workflowId",value:i,url:s.url,allowEmpty:!0})},se=async f=>{if(f){const{pollers:X}=await ut({namespace:r,queue:f});t(7,ae=X.length)}},O=async(f,X)=>{const U=await ct({namespace:r,workflowId:f,workflowType:X});if(t(5,q=U.input),t(3,b=q),t(4,W=Date.now()),U!=null&&U.searchAttributes){const $e=Object.keys(c);Object.entries(U.searchAttributes).forEach(([Y,Pe])=>{$e.includes(Y)&&t(9,j=[...j,{attribute:Y,value:String(Pe)}])}),t(8,N=!0)}},L=(f,X)=>{const U=f.target.value;Oe({parameter:X,value:U,url:s.url,allowEmpty:!0})},G=f=>{t(3,b=f),t(4,W=Date.now())};function pe(f){i=f,t(0,i)}const J=f=>L(f,"workflowId");function de(f){m=f,t(1,m)}const be=f=>L(f,"taskQueue");function oe(f){g=f,t(2,g)}const ge=f=>L(f,"workflowType");function fe(f){j=f,t(9,j)}const K=()=>t(8,N=!N);return l.$$.update=()=>{l.$$.dirty[0]&524288&&t(11,{namespace:r}=s.params,r),l.$$.dirty[0]&524288&&t(18,a=s.url.searchParams.get("taskQueue")),l.$$.dirty[0]&524295&&t(10,n=!!i&&!!m&&!!g&&!dt(s)),l.$$.dirty[0]&262144&&se(a)},[i,m,g,b,W,q,ee,ae,N,j,n,r,u,ce,me,H,L,G,a,s,pe,J,de,be,oe,ge,fe,K]}class Dt extends We{constructor(e){super(),je(this,e,St,At,De,{},null,[-1,-1])}}function Et(l){let e,t,r,a;return e=new lt({props:{title:"Start Workflow",url:l[0].url.href}}),r=new Dt({}),{c(){E(e.$$.fragment),t=S(),E(r.$$.fragment)},l(n){P(e.$$.fragment,n),t=D(n),P(r.$$.fragment,n)},m(n,s){Q(e,n,s),B(n,t,s),Q(r,n,s),a=!0},p(n,[s]){const c={};s&1&&(c.url=n[0].url.href),e.$set(c)},i(n){a||(p(e.$$.fragment,n),p(r.$$.fragment,n),a=!0)},o(n){w(e.$$.fragment,n),w(r.$$.fragment,n),a=!1},d(n){n&&_(t),V(e,n),V(r,n)}}}function Pt(l,e,t){let r;return Te(l,Ke,a=>t(0,r=a)),[r]}class er extends We{constructor(e){super(),je(this,e,Pt,Et,De,{})}}export{er as component,xt as universal};
