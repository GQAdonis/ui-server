import{r as Ge,e as Ke,h as Qe}from"./format-time.IvlILvlN.js";import{s as ue,h as y,j as D,k as I,f as m,m as w,i as L,c as ge,ac as Xe,w as ye,x as j,v as Q,b as O,d as W,n as _,y as Ze,r as Re,t as Y,l as G,H as ne,p as re,a1 as ze,q as le,Y as xe,o as $e,G as et,a as tt,u as nt,g as lt,e as st}from"./scheduler.tl3rb73C.js";import{S as ie,i as ce,c as X,a as Z,m as x,t as E,b as A,d as $,g as ke,e as pe}from"./index.iYEhKDTv.js";import{e as se,u as Je,o as ot,d as at}from"./each.Kfc4tziU.js";import{p as rt}from"./stores.KuAnTKmi.js";import{S as ut}from"./index.GTIw1tFG.js";import{b as Me}from"./workflow-counts.VmC1BKJ3.js";import{r as it,e as be,q as ct}from"./workflows.UcFajo8c.js";import{e as ft}from"./decode-payload.6NsoyWiz.js";import{W as dt}from"./workflow-status.bsoQpBdr.js";import{d as ht}from"./menu.3xnMBGxz.js";import{t as Ie}from"./translate.HrioCK44.js";import{w as Le,g as _t,a as qe}from"./time-picker.61qVFomL.js";import{I as Ve}from"./icon.6SImm5Yo.js";import{I as mt}from"./input.c1Zc_tmT.js";function gt(n,e){Ge(2,arguments);var t=Ke(n).getTime(),l=Qe(e);return new Date(t+l)}var bt=36e5;function Zt(n,e){Ge(2,arguments);var t=Qe(e);return gt(n,t*bt)}const we=["Running","TimedOut","Completed","Failed","ContinuedAsNew","Canceled","Terminated"];function xt(n){return we.includes(n)}const $t=["All",...we],Be=(n,e,t)=>{const o=Math.pow(3600/n,1/t),a=n*Math.pow(o,e);return Math.min(3600,Math.round(a))};function wt(n){let e,t;return e=new dt({props:{count:n[1],newCount:n[2],status:n[0],"test-id":"workflow-status-"+n[0]}}),{c(){X(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,o){x(e,l,o),t=!0},p(l,[o]){const a={};o&2&&(a.count=l[1]),o&4&&(a.newCount=l[2]),o&1&&(a.status=l[0]),o&1&&(a["test-id"]="workflow-status-"+l[0]),e.$set(a)},i(l){t||(E(e.$$.fragment,l),t=!0)},o(l){A(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function kt(n,e,t){let{status:l}=e,{count:o=0}=e,{newCount:a=0}=e;return n.$$set=u=>{"status"in u&&t(0,l=u.status),"count"in u&&t(1,o=u.count),"newCount"in u&&t(2,a=u.newCount)},[l,o,a]}class pt extends ie{constructor(e){super(),ce(this,e,kt,wt,ue,{status:0,count:1,newCount:2})}}function Oe(n,e,t){const l=n.slice();return l[19]=e[t].count,l[20]=e[t].status,l}function vt(n){let e,t;return e=new ut({props:{class:"h-6 w-24 rounded"}}),{c(){X(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,o){x(e,l,o),t=!0},p:Q,i(l){t||(E(e.$$.fragment,l),t=!0)},o(l){A(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function yt(n){let e,t;function l(...a){return n[9](n[20],...a)}function o(...a){return n[10](n[20],...a)}return e=new pt({props:{status:n[20],count:n[19],newCount:n[1].find(l)?n[1].find(o).count-n[19]:0}}),{c(){X(e.$$.fragment)},l(a){Z(e.$$.fragment,a)},m(a,u){x(e,a,u),t=!0},p(a,u){n=a;const i={};u&1&&(i.status=n[20]),u&1&&(i.count=n[19]),u&3&&(i.newCount=n[1].find(l)?n[1].find(o).count-n[19]:0),e.$set(i)},i(a){t||(E(e.$$.fragment,a),t=!0)},o(a){A(e.$$.fragment,a),t=!1},d(a){$(e,a)}}}function We(n,e){let t,l,o,a,u;const i=[yt,vt],s=[];function r(d,f){return d[2]?1:0}return l=r(e),o=s[l]=i[l](e),{key:n,first:null,c(){t=j(),o.c(),a=j(),this.h()},l(d){t=j(),o.l(d),a=j(),this.h()},h(){this.first=t},m(d,f){L(d,t,f),s[l].m(d,f),L(d,a,f),u=!0},p(d,f){e=d;let c=l;l=r(e),l===c?s[l].p(e,f):(ke(),A(s[c],1,1,()=>{s[c]=null}),pe(),o=s[l],o?o.p(e,f):(o=s[l]=i[l](e),o.c()),E(o,1),o.m(a.parentNode,a))},i(d){u||(E(o),u=!0)},o(d){A(o),u=!1},d(d){d&&(m(t),m(a)),s[l].d(d)}}}function Dt(n){let e,t=[],l=new Map,o,a=se(n[0]);const u=i=>i[20];for(let i=0;i<a.length;i+=1){let s=Oe(n,a,i),r=u(s);l.set(r,t[i]=We(r,s))}return{c(){e=y("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=D(i,"DIV",{class:!0});var s=I(e);for(let r=0;r<t.length;r+=1)t[r].l(s);s.forEach(m),this.h()},h(){w(e,"class","flex min-h-[24px] flex-wrap items-center gap-2")},m(i,s){L(i,e,s);for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(e,null);o=!0},p(i,[s]){s&7&&(a=se(i[0]),ke(),t=Je(t,s,u,1,i,a,l,e,ot,We,null,Oe),pe())},i(i){if(!o){for(let s=0;s<a.length;s+=1)E(t[s]);o=!0}},o(i){for(let s=0;s<t.length;s+=1)A(t[s]);o=!1},d(i){i&&m(e);for(let s=0;s<t.length;s+=1)t[s].d()}}}const Fe=5,De=100;function It(n,e,t){let l,o,a,u,i,s;ge(n,it,g=>t(6,a=g)),ge(n,be,g=>t(13,u=g)),ge(n,ct,g=>t(7,i=g)),ge(n,rt,g=>t(8,s=g));let{staticQuery:r=""}=e,d=[],f=[],c,h=1,k=!1;Xe(()=>{M()});const S=()=>{if(h+=1,clearInterval(c),h<=De){const g=Be(Fe,h,De)*1e3;c=setInterval(()=>J(),g)}},M=()=>{clearInterval(c),t(1,f=[]),ye(be,u.newCount=0,u),h=1,t(2,k=!0)},q=(g=[])=>g.map(p=>{const T=ft(p==null?void 0:p.groupValues[0]),b=parseInt(p.count);return{status:T,count:b}}).sort((p,T)=>we.indexOf(p.status)-we.indexOf(T.status)),J=async()=>{S();try{const{count:g,groups:p}=await Me({namespace:l,query:o});ye(be,u.newCount=parseInt(g)-u.count,u),t(1,f=q(p))}catch(g){console.error("Fetching workflow counts failed: ",g==null?void 0:g.message)}finally{t(2,k=!1)}},K=async()=>{M();const g=Be(Fe,h,De)*1e3;c=setInterval(()=>J(),g);try{const{count:p,groups:T}=await Me({namespace:l,query:o});ye(be,u.count=parseInt(p),u),t(0,d=q(T))}catch(p){console.error("Fetching workflow counts failed: ",p==null?void 0:p.message)}finally{t(2,k=!1)}},N=(g,p)=>p.status===g,F=(g,p)=>p.status===g;return n.$$set=g=>{"staticQuery"in g&&t(3,r=g.staticQuery)},n.$$.update=()=>{n.$$.dirty&256&&t(4,l=s.params.namespace),n.$$.dirty&136&&t(5,o=r||i),n.$$.dirty&112&&K()},[d,f,k,r,l,o,a,i,s,N,F]}class en extends ie{constructor(e){super(),ce(this,e,It,Dt,ue,{staticQuery:3})}}function He(n,e,t){const l=n.slice();return l[9]=e[t].allowed,l[10]=e[t].value,l[12]=t,l}function Pe(n,e,t){const l=n.slice();return l[13]=e[t],l}function je(n){let e,t=n[13].label.slice(0,2)+"",l;return{c(){e=y("p"),l=Y(t),this.h()},l(o){e=D(o,"P",{class:!0});var a=I(e);l=G(a,t),a.forEach(m),this.h()},h(){w(e,"class","cell svelte-1qa9vfx")},m(o,a){L(o,e,a),_(e,l)},p:Q,d(o){o&&m(e)}}}function Ct(n){let e;return{c(){e=y("div"),this.h()},l(t){e=D(t,"DIV",{class:!0}),I(e).forEach(m),this.h()},h(){w(e,"class","cell svelte-1qa9vfx")},m(t,l){L(t,e,l)},p:Q,d(t){t&&m(e)}}}function Et(n){let e,t=(n[10]||"")+"",l,o,a,u;function i(){return n[6](n[10])}return{c(){e=y("button"),l=Y(t),o=O(),this.h()},l(s){e=D(s,"BUTTON",{type:!0,class:!0});var r=I(e);l=G(r,t),o=W(r),r.forEach(m),this.h()},h(){w(e,"type","button"),w(e,"class","cell svelte-1qa9vfx"),ne(e,"highlight",n[9]&&n[10]),ne(e,"disabled",!n[9]),ne(e,"selected",new Date(n[0].getFullYear(),n[0].getMonth(),n[0].getDate()).getTime()===new Date(n[2],n[1],n[10]).getTime())},m(s,r){L(s,e,r),_(e,l),_(e,o),a||(u=re(e,"click",function(){ze(n[9]&&n[10]?i:Q)&&(n[9]&&n[10]?i:Q).apply(this,arguments)}),a=!0)},p(s,r){n=s,r&8&&t!==(t=(n[10]||"")+"")&&le(l,t),r&8&&ne(e,"highlight",n[9]&&n[10]),r&8&&ne(e,"disabled",!n[9]),r&15&&ne(e,"selected",new Date(n[0].getFullYear(),n[0].getMonth(),n[0].getDate()).getTime()===new Date(n[2],n[1],n[10]).getTime())},d(s){s&&m(e),a=!1,u()}}}function Ue(n,e){let t,l;function o(i,s){return i[10]?Et:Ct}let a=o(e),u=a(e);return{key:n,first:null,c(){t=j(),u.c(),l=j(),this.h()},l(i){t=j(),u.l(i),l=j(),this.h()},h(){this.first=t},m(i,s){L(i,t,s),u.m(i,s),L(i,l,s)},p(i,s){e=i,a===(a=o(e))&&u?u.p(e,s):(u.d(1),u=a(e),u&&(u.c(),u.m(l.parentNode,l)))},d(i){i&&(m(t),m(l)),u.d(i)}}}function St(n){let e,t,l,o,a=[],u=new Map,i=se(Le),s=[];for(let f=0;f<i.length;f+=1)s[f]=je(Pe(n,i,f));let r=se(n[3]);const d=f=>f[12];for(let f=0;f<r.length;f+=1){let c=He(n,r,f),h=d(c);u.set(h,a[f]=Ue(h,c))}return{c(){e=y("div"),t=y("div");for(let f=0;f<s.length;f+=1)s[f].c();l=O(),o=y("div");for(let f=0;f<a.length;f+=1)a[f].c();this.h()},l(f){e=D(f,"DIV",{class:!0});var c=I(e);t=D(c,"DIV",{class:!0});var h=I(t);for(let S=0;S<s.length;S+=1)s[S].l(h);h.forEach(m),l=W(c),o=D(c,"DIV",{class:!0});var k=I(o);for(let S=0;S<a.length;S+=1)a[S].l(k);k.forEach(m),c.forEach(m),this.h()},h(){w(t,"class","row svelte-1qa9vfx"),w(o,"class","row svelte-1qa9vfx"),w(e,"class","container svelte-1qa9vfx")},m(f,c){L(f,e,c),_(e,t);for(let h=0;h<s.length;h+=1)s[h]&&s[h].m(t,null);_(e,l),_(e,o);for(let h=0;h<a.length;h+=1)a[h]&&a[h].m(o,null)},p(f,[c]){if(c&0){i=se(Le);let h;for(h=0;h<i.length;h+=1){const k=Pe(f,i,h);s[h]?s[h].p(k,c):(s[h]=je(k),s[h].c(),s[h].m(t,null))}for(;h<s.length;h+=1)s[h].d(1);s.length=i.length}c&31&&(r=se(f[3]),a=Je(a,c,d,1,f,r,u,o,at,Ue,null,He))},i:Q,o:Q,d(f){f&&m(e),Ze(s,f);for(let c=0;c<a.length;c+=1)a[c].d()}}}function Tt(n,e,t){const l=Re();let{date:o}=e,{month:a}=e,{year:u}=e,{isAllowed:i=c=>!0}=e,s=[];const r=c=>{l("datechange",new Date(u,a,c))},d=(c,h,k)=>k?i(new Date(c,h,k)):!0,f=c=>r(c);return n.$$set=c=>{"date"in c&&t(0,o=c.date),"month"in c&&t(1,a=c.month),"year"in c&&t(2,u=c.year),"isAllowed"in c&&t(5,i=c.isAllowed)},n.$$.update=()=>{n.$$.dirty&6&&t(3,s=_t(a,u).map(c=>({value:c,allowed:d(u,a,c)})))},[o,a,u,s,r,i,f]}class At extends ie{constructor(e){super(),ce(this,e,Tt,St,ue,{date:0,month:1,year:2,isAllowed:5})}}function Ye(n){var Ee;let e,t,l,o,a,u,i,s,r,d,f=(((Ee=qe(n[8]))==null?void 0:Ee.label)??"")+"",c,h,k,S,M,q,J="Next Month",K,N,F,g,p,T,b,H,R,V,U,ee,oe,P,te,z,ve,Ce;return s=new Ve({props:{name:"chevron-left"}}),T=new Ve({props:{name:"chevron-right"}}),H=new At({props:{month:n[8],year:n[9],date:n[0],isAllowed:n[1]}}),H.$on("datechange",n[15]),{c(){e=y("div"),t=y("div"),l=y("div"),o=y("button"),a=y("span"),u=Y(n[16]),i=O(),X(s.$$.fragment),r=O(),d=y("div"),c=Y(f),h=O(),k=Y(n[9]),S=O(),M=y("div"),q=y("span"),q.textContent=J,K=O(),N=y("button"),F=y("span"),g=Y(n[17]),p=O(),X(T.$$.fragment),b=O(),X(H.$$.fragment),R=O(),V=y("div"),U=y("button"),ee=Y(n[4]),oe=O(),P=y("button"),te=Y(n[5]),this.h()},l(v){e=D(v,"DIV",{class:!0});var C=I(e);t=D(C,"DIV",{class:!0});var B=I(t);l=D(B,"DIV",{class:!0});var ae=I(l);o=D(ae,"BUTTON",{type:!0,title:!0});var fe=I(o);a=D(fe,"SPAN",{class:!0});var Se=I(a);u=G(Se,n[16]),Se.forEach(m),i=W(fe),Z(s.$$.fragment,fe),fe.forEach(m),ae.forEach(m),r=W(B),d=D(B,"DIV",{class:!0});var de=I(d);c=G(de,f),h=W(de),k=G(de,n[9]),de.forEach(m),S=W(B),M=D(B,"DIV",{class:!0});var he=I(M);q=D(he,"SPAN",{class:!0,"data-svelte-h":!0}),$e(q)!=="svelte-uyb8ys"&&(q.textContent=J),K=W(he),N=D(he,"BUTTON",{type:!0,title:!0});var _e=I(N);F=D(_e,"SPAN",{class:!0});var Te=I(F);g=G(Te,n[17]),Te.forEach(m),p=W(_e),Z(T.$$.fragment,_e),_e.forEach(m),he.forEach(m),B.forEach(m),b=W(C),Z(H.$$.fragment,C),R=W(C),V=D(C,"DIV",{class:!0});var me=I(V);U=D(me,"BUTTON",{type:!0,class:!0});var Ae=I(U);ee=G(Ae,n[4]),Ae.forEach(m),oe=W(me),P=D(me,"BUTTON",{type:!0,class:!0});var Ne=I(P);te=G(Ne,n[5]),Ne.forEach(m),me.forEach(m),C.forEach(m),this.h()},h(){w(a,"class","sr-only"),w(o,"type","button"),w(o,"title",n[16]),w(l,"class","flex items-center justify-center"),w(d,"class","flex items-center justify-center"),w(q,"class","sr-only"),w(F,"class","sr-only"),w(N,"type","button"),w(N,"title",n[17]),w(M,"class","flex items-center justify-center"),w(t,"class","mx-3 my-2 flex items-center justify-around"),w(U,"type","button"),w(U,"class","cursor-pointer text-[12px]"),w(P,"type","button"),w(P,"class","cursor-pointer text-[12px]"),w(V,"class","my-1 flex justify-between px-2"),w(e,"class","surface-primary absolute z-30 inline-block rounded border border-subtle shadow")},m(v,C){L(v,e,C),_(e,t),_(t,l),_(l,o),_(o,a),_(a,u),_(o,i),x(s,o,null),_(t,r),_(t,d),_(d,c),_(d,h),_(d,k),_(t,S),_(t,M),_(M,q),_(M,K),_(M,N),_(N,F),_(F,g),_(N,p),x(T,N,null),_(e,b),x(H,e,null),_(e,R),_(e,V),_(V,U),_(U,ee),_(V,oe),_(V,P),_(P,te),z=!0,ve||(Ce=[re(o,"click",n[14]),re(N,"click",n[13]),re(U,"click",n[18]),re(P,"click",n[19])],ve=!0)},p(v,C){var ae;(!z||C&256)&&f!==(f=(((ae=qe(v[8]))==null?void 0:ae.label)??"")+"")&&le(c,f),(!z||C&512)&&le(k,v[9]);const B={};C&256&&(B.month=v[8]),C&512&&(B.year=v[9]),C&1&&(B.date=v[0]),C&2&&(B.isAllowed=v[1]),H.$set(B),(!z||C&16)&&le(ee,v[4]),(!z||C&32)&&le(te,v[5])},i(v){z||(E(s.$$.fragment,v),E(T.$$.fragment,v),E(H.$$.fragment,v),z=!0)},o(v){A(s.$$.fragment,v),A(T.$$.fragment,v),A(H.$$.fragment,v),z=!1},d(v){v&&m(e),$(s),$(T),$(H),ve=!1,et(Ce)}}}function Nt(n){let e,t,l,o,a,u,i;t=new mt({props:{id:"datepicker",label:n[2],labelHidden:n[3],icon:"calendar-plus",type:"text",placeholder:"MM/DD/YY",value:n[0].toDateString(),clearable:!0,clearButtonLabel:n[6],disabled:n[7]}}),t.$on("focus",n[11]),t.$on("input",n[12]);let s=n[10]&&Ye(n);return{c(){e=y("div"),X(t.$$.fragment),l=O(),s&&s.c(),this.h()},l(r){e=D(r,"DIV",{class:!0});var d=I(e);Z(t.$$.fragment,d),l=W(d),s&&s.l(d),d.forEach(m),this.h()},h(){w(e,"class","relative")},m(r,d){L(r,e,d),x(t,e,null),_(e,l),s&&s.m(e,null),a=!0,u||(i=xe(o=ht.call(null,e,n[20])),u=!0)},p(r,[d]){const f={};d&4&&(f.label=r[2]),d&8&&(f.labelHidden=r[3]),d&1&&(f.value=r[0].toDateString()),d&64&&(f.clearButtonLabel=r[6]),d&128&&(f.disabled=r[7]),t.$set(f),r[10]?s?(s.p(r,d),d&1024&&E(s,1)):(s=Ye(r),s.c(),E(s,1),s.m(e,null)):s&&(ke(),A(s,1,1,()=>{s=null}),pe()),o&&ze(o.update)&&d&1024&&o.update.call(null,r[20])},i(r){a||(E(t.$$.fragment,r),E(s),a=!0)},o(r){A(t.$$.fragment,r),A(s),a=!1},d(r){r&&m(e),$(t),s&&s.d(),u=!1,i()}}}function Mt(n,e,t){const l=Re();let{isAllowed:o=()=>!0}=e,{selected:a=new Date}=e,{label:u}=e,{labelHidden:i=!1}=e,{todayLabel:s}=e,{closeLabel:r}=e,{clearLabel:d}=e,{disabled:f=!1}=e,c,h,k=!1;const S=()=>{t(10,k=!0)},M=b=>{const R=b.target.value;if(R.length===8){const V=R==null?void 0:R.split("/"),ee=2e3+parseInt(V[2]),oe=parseInt(V[0])-1,P=parseInt(V[1]),te=new Date(ee,oe,P);l("datechange",te)}},q=()=>{if(c===11){t(8,c=0),t(9,h=h+1);return}t(8,c=c+1)},J=()=>{if(c===0){t(8,c=11),t(9,h-=1);return}t(8,c-=1)},K=b=>{t(10,k=!1),l("datechange",b.detail)},N=Ie("date-picker.previous-month"),F=Ie("date-picker.next-month"),g=()=>t(0,a=new Date),p=()=>t(10,k=!1),T=()=>t(10,k=!1);return n.$$set=b=>{"isAllowed"in b&&t(1,o=b.isAllowed),"selected"in b&&t(0,a=b.selected),"label"in b&&t(2,u=b.label),"labelHidden"in b&&t(3,i=b.labelHidden),"todayLabel"in b&&t(4,s=b.todayLabel),"closeLabel"in b&&t(5,r=b.closeLabel),"clearLabel"in b&&t(6,d=b.clearLabel),"disabled"in b&&t(7,f=b.disabled)},n.$$.update=()=>{n.$$.dirty&1&&(t(8,c=a.getMonth()),t(9,h=a.getFullYear()))},[a,o,u,i,s,r,d,f,c,h,k,S,M,q,J,K,N,F,g,p,T]}class tn extends ie{constructor(e){super(),ce(this,e,Mt,Nt,ue,{isAllowed:1,selected:0,label:2,labelHidden:3,todayLabel:4,closeLabel:5,clearLabel:6,disabled:7})}}function Lt(n){let e;const t=n[5].default,l=tt(t,n,n[4],null);return{c(){l&&l.c()},l(o){l&&l.l(o)},m(o,a){l&&l.m(o,a),e=!0},p(o,a){l&&l.p&&(!e||a&16)&&nt(l,t,o,o[4],e?st(t,o[4],a,null):lt(o[4]),null)},i(o){e||(E(l,o),e=!0)},o(o){A(l,o),e=!1},d(o){l&&l.d(o)}}}function qt(n){let e;return{c(){e=Y(n[1])},l(t){e=G(t,n[1])},m(t,l){L(t,e,l)},p(t,l){l&2&&le(e,t[1])},i:Q,o:Q,d(t){t&&m(e)}}}function Vt(n){let e,t,l,o;const a=[qt,Lt],u=[];function i(s,r){return s[1]!==s[0]?0:1}return e=i(n),t=u[e]=a[e](n),{c(){t.c(),l=j()},l(s){t.l(s),l=j()},m(s,r){u[e].m(s,r),L(s,l,r),o=!0},p(s,[r]){let d=e;e=i(s),e===d?u[e].p(s,r):(ke(),A(u[d],1,1,()=>{u[d]=null}),pe(),t=u[e],t?t.p(s,r):(t=u[e]=a[e](s),t.c()),E(t,1),t.m(l.parentNode,l))},i(s){o||(E(t),o=!0)},o(s){A(t),o=!1},d(s){s&&m(l),u[e].d(s)}}}function Bt(n,e,t){let l,{$$slots:o={},$$scope:a}=e,{key:u}=e,{count:i=void 0}=e,{replace:s=void 0}=e;return n.$$set=r=>{"key"in r&&t(0,u=r.key),"count"in r&&t(2,i=r.count),"replace"in r&&t(3,s=r.replace),"$$scope"in r&&t(4,a=r.$$scope)},n.$$.update=()=>{n.$$.dirty&13&&t(1,l=Ie(u,{...s,count:i}))},[u,l,i,s,a,o]}class nn extends ie{constructor(e){super(),ce(this,e,Bt,Vt,ue,{key:0,count:2,replace:3})}}export{tn as D,nn as T,en as W,Zt as a,gt as b,xt as i,$t as w};
