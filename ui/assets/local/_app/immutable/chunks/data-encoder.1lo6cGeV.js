import{H as o}from"./scheduler.QPr9T_9m.js";import{p as i}from"./stores.JrL6Cew1.js";import{t as C}from"./translate.HrioCK44.js";import{a as v}from"./auth-user.OT1PH3-U.js";import{c as u,o as m,p as k,i as E,v as A,s as l,a as O}from"./is-http.o81NAhCN.js";import{h as y}from"./has.BboW8cQC.js";import{s as f}from"./parse-with-big-int.jPY5aC0s.js";const b=(e,a=u,n=m)=>{var r;return o(n)&&o(a)||((r=e==null?void 0:e.codec)==null?void 0:r.endpoint)||o(a)||""},P=(e,a=k,n=u,d=m)=>{var s,t;const r=o(d)&&o(n),p=(s=e==null?void 0:e.codec)!=null&&s.endpoint?!!((t=e==null?void 0:e.codec)!=null&&t.passAccessToken):!!o(a);return r?!!o(a):p},R=(e,a=E,n=u,d=m)=>{var s,t;const r=o(d)&&o(n),p=(s=e==null?void 0:e.codec)!=null&&s.endpoint?!!((t=e==null?void 0:e.codec)!=null&&t.includeCredentials):!!o(a);return r?!!o(a):p};async function h({type:e,payloads:a,namespace:n=o(i).params.namespace,settings:d=o(i).data.settings}){const r=b(d),p=P(d),s=R(d),t={"Content-Type":"application/json","X-Namespace":n};if(p)if(A(r)){let c=o(v).accessToken;globalThis!=null&&globalThis.AccessToken&&(c=await(globalThis==null?void 0:globalThis.AccessToken())),t.Authorization=`Bearer ${c}`}else return l(),a;const T=s?{headers:t,credentials:"include",method:"POST",body:f(a)}:{headers:t,method:"POST",body:f(a)};return fetch(r+`/${e}`,T).then(c=>{if(y(c,"ok")&&!c.ok)throw{statusCode:c.status,statusText:c.statusText,response:c,message:C(`common.${e}-failed`)};return c.json()}).then(c=>(O(),c)).catch(c=>{if(l(c),e==="decode")return a;throw c})}async function D({payloads:e,namespace:a=o(i).params.namespace,settings:n=o(i).data.settings}){return h({type:"decode",payloads:e,namespace:a,settings:n})}async function H({payloads:e,namespace:a=o(i).params.namespace,settings:n=o(i).data.settings}){return h({type:"encode",payloads:e,namespace:a,settings:n})}export{P as a,R as b,D as d,H as e,b as g};
