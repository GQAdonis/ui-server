import{C as o}from"./scheduler.BTg3iwM1.js";import{p as i}from"./stores.DmuRhXoi.js";import{t as C}from"./translate.BBe5dcco.js";import{a as v}from"./auth-user.CEd0m9aK.js";import{c as u,o as m,p as k,i as E,v as A,s as l,a as O}from"./is-http.7lgaw9Ku.js";import{s as f}from"./parse-with-big-int.BKSBwM2t.js";const y=(e,a=u,n=m)=>{var r;return o(n)&&o(a)||((r=e==null?void 0:e.codec)==null?void 0:r.endpoint)||o(a)||""},b=(e,a=k,n=u,d=m)=>{var s,t;const r=o(d)&&o(n),p=(s=e==null?void 0:e.codec)!=null&&s.endpoint?!!((t=e==null?void 0:e.codec)!=null&&t.passAccessToken):!!o(a);return r?!!o(a):p},P=(e,a=E,n=u,d=m)=>{var s,t;const r=o(d)&&o(n),p=(s=e==null?void 0:e.codec)!=null&&s.endpoint?!!((t=e==null?void 0:e.codec)!=null&&t.includeCredentials):!!o(a);return r?!!o(a):p};async function h({type:e,payloads:a,namespace:n=o(i).params.namespace,settings:d=o(i).data.settings}){const r=y(d),p=b(d),s=P(d),t={"Content-Type":"application/json","X-Namespace":n};if(p)if(A(r)){let c=o(v).accessToken;globalThis!=null&&globalThis.AccessToken&&(c=await(globalThis==null?void 0:globalThis.AccessToken())),t.Authorization=`Bearer ${c}`}else return l(),a;const T=s?{headers:t,credentials:"include",method:"POST",body:f(a)}:{headers:t,method:"POST",body:f(a)};return fetch(r+`/${e}`,T).then(c=>{if(c.ok===!1)throw{statusCode:c.status,statusText:c.statusText,response:c,message:C(`common.${e}-failed`)};return c.json()}).then(c=>(O(),c)).catch(c=>{if(l(c),e==="decode")return a;throw c})}async function q({payloads:e,namespace:a=o(i).params.namespace,settings:n=o(i).data.settings}){return h({type:"decode",payloads:e,namespace:a,settings:n})}async function B({payloads:e,namespace:a=o(i).params.namespace,settings:n=o(i).data.settings}){return h({type:"encode",payloads:e,namespace:a,settings:n})}export{b as a,P as b,q as d,B as e,y as g};
