import{S as U,i as X,s as Y,j as N,m as S,o as j,x as d,u as v,v as T,l as ae,f as y,r as Ee,w as Ae,d as i,t as P,g as W,e as k,c as g,a as b,b as h,R as ge,Q as _,G as pe,h as Q,k as I,n as E,J as u,ad as be,ae as ye,N as Ne,ar as Se,as as je,I as Te,K as Pe,L as We,M as De,y as Re}from"../../../../../../chunks/vendor-b93e428e.js";import{W as Ce,a as Fe}from"../../../../../../chunks/workflow-status-d9ed7bd5.js";import{r as He}from"../../../../../../chunks/refreshable-9bcf1376.js";import{r as qe,a as Me,h as Be}from"../../../../../../chunks/route-for-api-897023e4.js";import{n as Je}from"../../../../../../chunks/notifications-f504753b.js";import{B as Le}from"../../../../../../chunks/button-98d9f968.js";import{g as $e}from"../../../../../../chunks/get-context-97f7fcbb.js";import{p as ve}from"../../../../../../chunks/stores-668dfc14.js";import{r as ne}from"../../../../../../chunks/route-for-c019a53c.js";async function Oe({workflow:s,namespace:e,reason:a}){return await qe(Me("workflow.terminate",{namespace:e,executionId:s.id,runId:s.runId}),{options:{method:"POST",body:JSON.stringify({reason:a})},shouldRetry:!1})}function Ie(s){let e,a;return e=new Le({props:{destroy:!0,$$slots:{default:[Qe]},$$scope:{ctx:s}}}),e.$on("click",s[2]),{c(){N(e.$$.fragment)},l(l){S(e.$$.fragment,l)},m(l,t){j(e,l,t),a=!0},p(l,t){const n={};t&128&&(n.$$scope={dirty:t,ctx:l}),e.$set(n)},i(l){a||(d(e.$$.fragment,l),a=!0)},o(l){v(e.$$.fragment,l),a=!1},d(l){T(e,l)}}}function Qe(s){let e;return{c(){e=P("Terminate")},l(a){e=W(a,"Terminate")},m(a,l){y(a,e,l)},d(a){a&&i(e)}}}function Ve(s){let e=s[1](s[0]),a,l,t=e&&Ie(s);return{c(){t&&t.c(),a=ae()},l(n){t&&t.l(n),a=ae()},m(n,r){t&&t.m(n,r),y(n,a,r),l=!0},p(n,[r]){r&1&&(e=n[1](n[0])),e?t?(t.p(n,r),r&1&&d(t,1)):(t=Ie(n),t.c(),d(t,1),t.m(a.parentNode,a)):t&&(Ee(),v(t,1,1,()=>{t=null}),Ae())},i(n){l||(d(t),l=!0)},o(n){v(t),l=!1},d(n){t&&t.d(n),n&&i(a)}}}function Ge(s,e,a){let{workflow:l}=e,{namespace:t}=e,n="";const{refresh:r}=$e("workflow"),f=c=>String(c.status)==="Running",o=()=>{n="",Je.add("success","Workflow Terminated"),r()},p=()=>{Oe({workflow:l,namespace:t,reason:n}).then(o).catch(Be)};return s.$$set=c=>{"workflow"in c&&a(0,l=c.workflow),"namespace"in c&&a(3,t=c.namespace)},[l,f,p,t]}class Ke extends U{constructor(e){super();X(this,e,Ge,Ve,Y,{workflow:0,namespace:3})}}function ze(s){let e;return{c(){e=P(s[1])},l(a){e=W(a,s[1])},m(a,l){y(a,e,l)},p(a,l){l&2&&Q(e,a[1])},d(a){a&&i(e)}}}function Ue(s){let e,a,l,t;return{c(){e=P(s[1]),a=I(),l=k("span"),t=P(s[2]),this.h()},l(n){e=W(n,s[1]),a=E(n),l=g(n,"SPAN",{class:!0});var r=b(l);t=W(r,s[2]),r.forEach(i),this.h()},h(){h(l,"class","px-2 text-blue-700 bg-blue-100 rounded-sm")},m(n,r){y(n,e,r),y(n,a,r),y(n,l,r),u(l,t)},p(n,r){r&2&&Q(e,n[1]),r&4&&Q(t,n[2])},d(n){n&&i(e),n&&i(a),n&&i(l)}}}function Xe(s){let e;function a(n,r){return n[2]?Ue:ze}let l=a(s),t=l(s);return{c(){e=k("a"),t.c(),this.h()},l(n){e=g(n,"A",{class:!0,href:!0});var r=b(e);t.l(r),r.forEach(i),this.h()},h(){h(e,"class","block svelte-tavydt"),h(e,"href",s[0]),ge(e,"active",s[3])},m(n,r){y(n,e,r),t.m(e,null)},p(n,[r]){l===(l=a(n))&&t?t.p(n,r):(t.d(1),t=l(n),t&&(t.c(),t.m(e,null))),r&1&&h(e,"href",n[0]),r&8&&ge(e,"active",n[3])},i:_,o:_,d(n){n&&i(e),t.d()}}}function Ye(s,e,a){let l,t;pe(s,ve,o=>a(4,t=o));let{href:n}=e,{label:r}=e,{amount:f=null}=e;return s.$$set=o=>{"href"in o&&a(0,n=o.href),"label"in o&&a(1,r=o.label),"amount"in o&&a(2,f=o.amount)},s.$$.update=()=>{s.$$.dirty&17&&a(3,l=t.path.includes(n))},[n,r,f,l,t]}class se extends U{constructor(e){super();X(this,e,Ye,Xe,Y,{href:0,label:1,amount:2})}}function Ze(s){let e,a,l,t,n,r,f,o,p;return a=new se({props:{label:"History",href:ne("workflow.events",{namespace:s[0],workflowId:s[1],runId:s[2]}),amount:s[3]}}),t=new se({props:{label:"Workers",href:ne("workers",{namespace:s[0],workflowId:s[1],runId:s[2]})}}),r=new se({props:{label:"Stack Trace",href:ne("workflow.stack-trace",{namespace:s[0],workflowId:s[1],runId:s[2]})}}),o=new se({props:{label:"Query",href:ne("workflow.query",{namespace:s[0],workflowId:s[1],runId:s[2]})}}),{c(){e=k("nav"),N(a.$$.fragment),l=I(),N(t.$$.fragment),n=I(),N(r.$$.fragment),f=I(),N(o.$$.fragment),this.h()},l(c){e=g(c,"NAV",{class:!0});var $=b(e);S(a.$$.fragment,$),l=E($),S(t.$$.fragment,$),n=E($),S(r.$$.fragment,$),f=E($),S(o.$$.fragment,$),$.forEach(i),this.h()},h(){h(e,"class","flex gap-6")},m(c,$){y(c,e,$),j(a,e,null),u(e,l),j(t,e,null),u(e,n),j(r,e,null),u(e,f),j(o,e,null),p=!0},p:_,i(c){p||(d(a.$$.fragment,c),d(t.$$.fragment,c),d(r.$$.fragment,c),d(o.$$.fragment,c),p=!0)},o(c){v(a.$$.fragment,c),v(t.$$.fragment,c),v(r.$$.fragment,c),v(o.$$.fragment,c),p=!1},d(c){c&&i(e),T(a),T(t),T(r),T(o)}}}function xe(s,e,a){let l;pe(s,ve,p=>a(5,l=p));let{workflow:t}=e;const{namespace:n,workflow:r,run:f}=l.params,o=t==null?void 0:t.historyEvents;return s.$$set=p=>{"workflow"in p&&a(4,t=p.workflow)},[n,r,f,o,t]}class et extends U{constructor(e){super();X(this,e,xe,Ze,Y,{workflow:4})}}function tt(s){return{c:_,l:_,m:_,p:_,i:_,o:_,d:_}}function at(s){var he;let e,a,l,t,n,r,f,o,p=s[2].name+"",c,$,D,re,R,le,C,V,oe,fe,J,G=s[2].id+"",Z,ue,F,K,ce,ie,L,z=s[2].runId+"",x,me,H,q;return t=new Ne({props:{icon:Se}}),D=new Ce({props:{status:(he=s[2])==null?void 0:he.status}}),R=new Ke({props:{workflow:s[2],namespace:s[0]}}),H=new et({props:{workflow:s[2]}}),{c(){e=k("header"),a=k("main"),l=k("a"),N(t.$$.fragment),r=I(),f=k("div"),o=k("h1"),c=P(p),$=I(),N(D.$$.fragment),re=I(),N(R.$$.fragment),le=I(),C=k("p"),V=k("span"),oe=P("Workflow ID"),fe=I(),J=k("span"),Z=P(G),ue=I(),F=k("p"),K=k("span"),ce=P("Run ID"),ie=I(),L=k("span"),x=P(z),me=I(),N(H.$$.fragment),this.h()},l(m){e=g(m,"HEADER",{class:!0});var w=b(e);a=g(w,"MAIN",{class:!0});var A=b(a);l=g(A,"A",{href:!0,class:!0,style:!0});var O=b(l);S(t.$$.fragment,O),O.forEach(i),r=E(A),f=g(A,"DIV",{class:!0});var M=b(f);o=g(M,"H1",{class:!0});var B=b(o);c=W(B,p),$=E(B),S(D.$$.fragment,B),B.forEach(i),re=E(M),S(R.$$.fragment,M),M.forEach(i),le=E(A),C=g(A,"P",{class:!0});var ee=b(C);V=g(ee,"SPAN",{});var _e=b(V);oe=W(_e,"Workflow ID"),_e.forEach(i),fe=E(ee),J=g(ee,"SPAN",{class:!0});var we=b(J);Z=W(we,G),we.forEach(i),ee.forEach(i),ue=E(A),F=g(A,"P",{class:!0});var te=b(F);K=g(te,"SPAN",{});var de=b(K);ce=W(de,"Run ID"),de.forEach(i),ie=E(te),L=g(te,"SPAN",{class:!0});var ke=b(L);x=W(ke,z),ke.forEach(i),te.forEach(i),A.forEach(i),me=E(w),S(H.$$.fragment,w),w.forEach(i),this.h()},h(){h(l,"href",n="/namespaces/"+s[0]+"/workflows"),h(l,"class","absolute top-2 back-to-workflows"),je(l,"left","-1.5rem"),h(o,"class","text-2xl"),h(f,"class","flex justify-between items-center"),h(J,"class","font-medium"),h(C,"class","text-md"),h(L,"class","font-medium"),h(F,"class","text-md"),h(a,"class","flex flex-col gap-1 relative"),h(e,"class","flex flex-col gap-4")},m(m,w){y(m,e,w),u(e,a),u(a,l),j(t,l,null),u(a,r),u(a,f),u(f,o),u(o,c),u(o,$),j(D,o,null),u(f,re),j(R,f,null),u(a,le),u(a,C),u(C,V),u(V,oe),u(C,fe),u(C,J),u(J,Z),u(a,ue),u(a,F),u(F,K),u(K,ce),u(F,ie),u(F,L),u(L,x),u(e,me),j(H,e,null),q=!0},p(m,w){var B;(!q||w&1&&n!==(n="/namespaces/"+m[0]+"/workflows"))&&h(l,"href",n),(!q||w&2)&&p!==(p=m[2].name+"")&&Q(c,p);const A={};w&2&&(A.status=(B=m[2])==null?void 0:B.status),D.$set(A);const O={};w&2&&(O.workflow=m[2]),w&1&&(O.namespace=m[0]),R.$set(O),(!q||w&2)&&G!==(G=m[2].id+"")&&Q(Z,G),(!q||w&2)&&z!==(z=m[2].runId+"")&&Q(x,z);const M={};w&2&&(M.workflow=m[2]),H.$set(M)},i(m){q||(d(t.$$.fragment,m),d(D.$$.fragment,m),d(R.$$.fragment,m),d(H.$$.fragment,m),q=!0)},o(m){v(t.$$.fragment,m),v(D.$$.fragment,m),v(R.$$.fragment,m),v(H.$$.fragment,m),q=!1},d(m){m&&i(e),T(t),T(D),T(R),T(H)}}}function nt(s){return{c:_,l:_,m:_,p:_,i:_,o:_,d:_}}function st(s){let e,a,l,t={ctx:s,current:null,token:null,hasCatch:!1,pending:nt,then:at,catch:tt,value:2,blocks:[,,,]};return be(a=s[1],t),{c(){e=ae(),t.block.c()},l(n){e=ae(),t.block.l(n)},m(n,r){y(n,e,r),t.block.m(n,t.anchor=r),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(n,[r]){s=n,t.ctx=s,r&2&&a!==(a=s[1])&&be(a,t)||ye(t,s,r)},i(n){l||(d(t.block),l=!0)},o(n){for(let r=0;r<3;r+=1){const f=t.blocks[r];v(f)}l=!1},d(n){n&&i(e),t.block.d(n),t.token=null,t=null}}}function rt(s,e,a){let l,{namespace:t}=e,n=$e("workflow");return pe(s,n,r=>a(1,l=r)),s.$$set=r=>{"namespace"in r&&a(0,t=r.namespace)},[t,l,n]}class lt extends U{constructor(e){super();X(this,e,rt,st,Y,{namespace:0})}}function ot(s){let e,a,l,t;a=new lt({props:{namespace:s[0]}});const n=s[3].default,r=Te(n,s,s[2],null);return{c(){e=k("main"),N(a.$$.fragment),l=I(),r&&r.c(),this.h()},l(f){e=g(f,"MAIN",{class:!0});var o=b(e);S(a.$$.fragment,o),l=E(o),r&&r.l(o),o.forEach(i),this.h()},h(){h(e,"class","flex flex-col gap-6 h-full")},m(f,o){y(f,e,o),j(a,e,null),u(e,l),r&&r.m(e,null),t=!0},p(f,[o]){const p={};o&1&&(p.namespace=f[0]),a.$set(p),r&&r.p&&(!t||o&4)&&Pe(r,n,f,f[2],t?De(n,f[2],o,null):We(f[2]),null)},i(f){t||(d(a.$$.fragment,f),d(r,f),t=!0)},o(f){v(a.$$.fragment,f),v(r,f),t=!1},d(f){f&&i(e),T(a),r&&r.d(f)}}}async function kt({page:s}){const{workflow:e,run:a,namespace:l}=s.params;return{props:{parameters:{namespace:l,executionId:e,runId:a},namespace:l}}}function ft(s,e,a){let{$$slots:l={},$$scope:t}=e,{parameters:n}=e,{namespace:r}=e,f=He(()=>Fe(n));return s.$$set=o=>{"parameters"in o&&a(1,n=o.parameters),"namespace"in o&&a(0,r=o.namespace),"$$scope"in o&&a(2,t=o.$$scope)},Re("workflow",f),[r,n,t,l]}class gt extends U{constructor(e){super();X(this,e,ft,ot,Y,{parameters:1,namespace:0})}}export{gt as default,kt as load};
